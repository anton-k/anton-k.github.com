<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="./style.css" type="text/css" />
  <script type="text/javascript">/*<![CDATA[*/
  /*
  LaTeXMathML.js from http://math.etsu.edu/LaTeXMathML/
  Adapted by Jeff Knisely and Douglas Woodall from ASCIIMathML.js v. 1.4.7,
  (c) 2005 Peter Jipsen http://www.chapman.edu/~jipsen.
  Released under the GNU General Public License version 2 or later.
  See the GNU General Public License (at http://www.gnu.org/copyleft/gpl.html)
  for more details.
  */
  var checkForMathML=true;var notifyIfNoMathML=true;var alertIfNoMathML=false;var mathcolor="";var mathfontfamily="";var showasciiformulaonhover=true;var isIE=document.createElementNS==null;if(document.getElementById==null)
  alert("This webpage requires a recent browser such as \nMozilla/Netscape 7+ or Internet Explorer 6+MathPlayer")
  function AMcreateElementXHTML(t){if(isIE)return document.createElement(t);else return document.createElementNS("http://www.w3.org/1999/xhtml",t);}
  function AMnoMathMLNote(){var nd=AMcreateElementXHTML("h3");nd.setAttribute("align","center")
  nd.appendChild(AMcreateElementXHTML("p"));nd.appendChild(document.createTextNode("To view the "));var an=AMcreateElementXHTML("a");an.appendChild(document.createTextNode("LaTeXMathML"));an.setAttribute("href","http://www.maths.nott.ac.uk/personal/drw/lm.html");nd.appendChild(an);nd.appendChild(document.createTextNode(" notation use Internet Explorer 6+"));an=AMcreateElementXHTML("a");an.appendChild(document.createTextNode("MathPlayer"));an.setAttribute("href","http://www.dessci.com/en/products/mathplayer/download.htm");nd.appendChild(an);nd.appendChild(document.createTextNode(" or Netscape/Mozilla/Firefox"));nd.appendChild(AMcreateElementXHTML("p"));return nd;}
  function AMisMathMLavailable(){if(navigator.appName.slice(0,8)=="Netscape")
  if(navigator.appVersion.slice(0,1)>="5")return null;else return AMnoMathMLNote();else if(navigator.appName.slice(0,9)=="Microsoft")
  try{var ActiveX=new ActiveXObject("MathPlayer.Factory.1");return null;}catch(e){return AMnoMathMLNote();}
  else return AMnoMathMLNote();}
  var AMcal=[0xEF35,0x212C,0xEF36,0xEF37,0x2130,0x2131,0xEF38,0x210B,0x2110,0xEF39,0xEF3A,0x2112,0x2133,0xEF3B,0xEF3C,0xEF3D,0xEF3E,0x211B,0xEF3F,0xEF40,0xEF41,0xEF42,0xEF43,0xEF44,0xEF45,0xEF46];var AMfrk=[0xEF5D,0xEF5E,0x212D,0xEF5F,0xEF60,0xEF61,0xEF62,0x210C,0x2111,0xEF63,0xEF64,0xEF65,0xEF66,0xEF67,0xEF68,0xEF69,0xEF6A,0x211C,0xEF6B,0xEF6C,0xEF6D,0xEF6E,0xEF6F,0xEF70,0xEF71,0x2128];var AMbbb=[0xEF8C,0xEF8D,0x2102,0xEF8E,0xEF8F,0xEF90,0xEF91,0x210D,0xEF92,0xEF93,0xEF94,0xEF95,0xEF96,0x2115,0xEF97,0x2119,0x211A,0x211D,0xEF98,0xEF99,0xEF9A,0xEF9B,0xEF9C,0xEF9D,0xEF9E,0x2124];var CONST=0,UNARY=1,BINARY=2,INFIX=3,LEFTBRACKET=4,RIGHTBRACKET=5,SPACE=6,UNDEROVER=7,DEFINITION=8,TEXT=9,BIG=10,LONG=11,STRETCHY=12,MATRIX=13;var AMsqrt={input:"\\sqrt",tag:"msqrt",output:"sqrt",ttype:UNARY},AMroot={input:"\\root",tag:"mroot",output:"root",ttype:BINARY},AMfrac={input:"\\frac",tag:"mfrac",output:"/",ttype:BINARY},AMover={input:"\\stackrel",tag:"mover",output:"stackrel",ttype:BINARY},AMatop={input:"\\atop",tag:"mfrac",output:"",ttype:INFIX},AMchoose={input:"\\choose",tag:"mfrac",output:"",ttype:INFIX},AMsub={input:"_",tag:"msub",output:"_",ttype:INFIX},AMsup={input:"^",tag:"msup",output:"^",ttype:INFIX},AMtext={input:"\\mathrm",tag:"mtext",output:"text",ttype:TEXT},AMmbox={input:"\\mbox",tag:"mtext",output:"mbox",ttype:TEXT};var AMsymbols=[{input:"\\alpha",tag:"mi",output:"\u03B1",ttype:CONST},{input:"\\beta",tag:"mi",output:"\u03B2",ttype:CONST},{input:"\\gamma",tag:"mi",output:"\u03B3",ttype:CONST},{input:"\\delta",tag:"mi",output:"\u03B4",ttype:CONST},{input:"\\epsilon",tag:"mi",output:"\u03B5",ttype:CONST},{input:"\\varepsilon",tag:"mi",output:"\u025B",ttype:CONST},{input:"\\zeta",tag:"mi",output:"\u03B6",ttype:CONST},{input:"\\eta",tag:"mi",output:"\u03B7",ttype:CONST},{input:"\\theta",tag:"mi",output:"\u03B8",ttype:CONST},{input:"\\vartheta",tag:"mi",output:"\u03D1",ttype:CONST},{input:"\\iota",tag:"mi",output:"\u03B9",ttype:CONST},{input:"\\kappa",tag:"mi",output:"\u03BA",ttype:CONST},{input:"\\lambda",tag:"mi",output:"\u03BB",ttype:CONST},{input:"\\mu",tag:"mi",output:"\u03BC",ttype:CONST},{input:"\\nu",tag:"mi",output:"\u03BD",ttype:CONST},{input:"\\xi",tag:"mi",output:"\u03BE",ttype:CONST},{input:"\\pi",tag:"mi",output:"\u03C0",ttype:CONST},{input:"\\varpi",tag:"mi",output:"\u03D6",ttype:CONST},{input:"\\rho",tag:"mi",output:"\u03C1",ttype:CONST},{input:"\\varrho",tag:"mi",output:"\u03F1",ttype:CONST},{input:"\\varsigma",tag:"mi",output:"\u03C2",ttype:CONST},{input:"\\sigma",tag:"mi",output:"\u03C3",ttype:CONST},{input:"\\tau",tag:"mi",output:"\u03C4",ttype:CONST},{input:"\\upsilon",tag:"mi",output:"\u03C5",ttype:CONST},{input:"\\phi",tag:"mi",output:"\u03C6",ttype:CONST},{input:"\\varphi",tag:"mi",output:"\u03D5",ttype:CONST},{input:"\\chi",tag:"mi",output:"\u03C7",ttype:CONST},{input:"\\psi",tag:"mi",output:"\u03C8",ttype:CONST},{input:"\\omega",tag:"mi",output:"\u03C9",ttype:CONST},{input:"\\Gamma",tag:"mo",output:"\u0393",ttype:CONST},{input:"\\Delta",tag:"mo",output:"\u0394",ttype:CONST},{input:"\\Theta",tag:"mo",output:"\u0398",ttype:CONST},{input:"\\Lambda",tag:"mo",output:"\u039B",ttype:CONST},{input:"\\Xi",tag:"mo",output:"\u039E",ttype:CONST},{input:"\\Pi",tag:"mo",output:"\u03A0",ttype:CONST},{input:"\\Sigma",tag:"mo",output:"\u03A3",ttype:CONST},{input:"\\Upsilon",tag:"mo",output:"\u03A5",ttype:CONST},{input:"\\Phi",tag:"mo",output:"\u03A6",ttype:CONST},{input:"\\Psi",tag:"mo",output:"\u03A8",ttype:CONST},{input:"\\Omega",tag:"mo",output:"\u03A9",ttype:CONST},{input:"\\frac12",tag:"mo",output:"\u00BD",ttype:CONST},{input:"\\frac14",tag:"mo",output:"\u00BC",ttype:CONST},{input:"\\frac34",tag:"mo",output:"\u00BE",ttype:CONST},{input:"\\frac13",tag:"mo",output:"\u2153",ttype:CONST},{input:"\\frac23",tag:"mo",output:"\u2154",ttype:CONST},{input:"\\frac15",tag:"mo",output:"\u2155",ttype:CONST},{input:"\\frac25",tag:"mo",output:"\u2156",ttype:CONST},{input:"\\frac35",tag:"mo",output:"\u2157",ttype:CONST},{input:"\\frac45",tag:"mo",output:"\u2158",ttype:CONST},{input:"\\frac16",tag:"mo",output:"\u2159",ttype:CONST},{input:"\\frac56",tag:"mo",output:"\u215A",ttype:CONST},{input:"\\frac18",tag:"mo",output:"\u215B",ttype:CONST},{input:"\\frac38",tag:"mo",output:"\u215C",ttype:CONST},{input:"\\frac58",tag:"mo",output:"\u215D",ttype:CONST},{input:"\\frac78",tag:"mo",output:"\u215E",ttype:CONST},{input:"\\pm",tag:"mo",output:"\u00B1",ttype:CONST},{input:"\\mp",tag:"mo",output:"\u2213",ttype:CONST},{input:"\\triangleleft",tag:"mo",output:"\u22B2",ttype:CONST},{input:"\\triangleright",tag:"mo",output:"\u22B3",ttype:CONST},{input:"\\cdot",tag:"mo",output:"\u22C5",ttype:CONST},{input:"\\star",tag:"mo",output:"\u22C6",ttype:CONST},{input:"\\ast",tag:"mo",output:"\u002A",ttype:CONST},{input:"\\times",tag:"mo",output:"\u00D7",ttype:CONST},{input:"\\div",tag:"mo",output:"\u00F7",ttype:CONST},{input:"\\circ",tag:"mo",output:"\u2218",ttype:CONST},{input:"\\bullet",tag:"mo",output:"\u2022",ttype:CONST},{input:"\\oplus",tag:"mo",output:"\u2295",ttype:CONST},{input:"\\ominus",tag:"mo",output:"\u2296",ttype:CONST},{input:"\\otimes",tag:"mo",output:"\u2297",ttype:CONST},{input:"\\bigcirc",tag:"mo",output:"\u25CB",ttype:CONST},{input:"\\oslash",tag:"mo",output:"\u2298",ttype:CONST},{input:"\\odot",tag:"mo",output:"\u2299",ttype:CONST},{input:"\\land",tag:"mo",output:"\u2227",ttype:CONST},{input:"\\wedge",tag:"mo",output:"\u2227",ttype:CONST},{input:"\\lor",tag:"mo",output:"\u2228",ttype:CONST},{input:"\\vee",tag:"mo",output:"\u2228",ttype:CONST},{input:"\\cap",tag:"mo",output:"\u2229",ttype:CONST},{input:"\\cup",tag:"mo",output:"\u222A",ttype:CONST},{input:"\\sqcap",tag:"mo",output:"\u2293",ttype:CONST},{input:"\\sqcup",tag:"mo",output:"\u2294",ttype:CONST},{input:"\\uplus",tag:"mo",output:"\u228E",ttype:CONST},{input:"\\amalg",tag:"mo",output:"\u2210",ttype:CONST},{input:"\\bigtriangleup",tag:"mo",output:"\u25B3",ttype:CONST},{input:"\\bigtriangledown",tag:"mo",output:"\u25BD",ttype:CONST},{input:"\\dag",tag:"mo",output:"\u2020",ttype:CONST},{input:"\\dagger",tag:"mo",output:"\u2020",ttype:CONST},{input:"\\ddag",tag:"mo",output:"\u2021",ttype:CONST},{input:"\\ddagger",tag:"mo",output:"\u2021",ttype:CONST},{input:"\\lhd",tag:"mo",output:"\u22B2",ttype:CONST},{input:"\\rhd",tag:"mo",output:"\u22B3",ttype:CONST},{input:"\\unlhd",tag:"mo",output:"\u22B4",ttype:CONST},{input:"\\unrhd",tag:"mo",output:"\u22B5",ttype:CONST},{input:"\\sum",tag:"mo",output:"\u2211",ttype:UNDEROVER},{input:"\\prod",tag:"mo",output:"\u220F",ttype:UNDEROVER},{input:"\\bigcap",tag:"mo",output:"\u22C2",ttype:UNDEROVER},{input:"\\bigcup",tag:"mo",output:"\u22C3",ttype:UNDEROVER},{input:"\\bigwedge",tag:"mo",output:"\u22C0",ttype:UNDEROVER},{input:"\\bigvee",tag:"mo",output:"\u22C1",ttype:UNDEROVER},{input:"\\bigsqcap",tag:"mo",output:"\u2A05",ttype:UNDEROVER},{input:"\\bigsqcup",tag:"mo",output:"\u2A06",ttype:UNDEROVER},{input:"\\coprod",tag:"mo",output:"\u2210",ttype:UNDEROVER},{input:"\\bigoplus",tag:"mo",output:"\u2A01",ttype:UNDEROVER},{input:"\\bigotimes",tag:"mo",output:"\u2A02",ttype:UNDEROVER},{input:"\\bigodot",tag:"mo",output:"\u2A00",ttype:UNDEROVER},{input:"\\biguplus",tag:"mo",output:"\u2A04",ttype:UNDEROVER},{input:"\\int",tag:"mo",output:"\u222B",ttype:CONST},{input:"\\oint",tag:"mo",output:"\u222E",ttype:CONST},{input:":=",tag:"mo",output:":=",ttype:CONST},{input:"\\lt",tag:"mo",output:"<",ttype:CONST},{input:"\\gt",tag:"mo",output:">",ttype:CONST},{input:"\\ne",tag:"mo",output:"\u2260",ttype:CONST},{input:"\\neq",tag:"mo",output:"\u2260",ttype:CONST},{input:"\\le",tag:"mo",output:"\u2264",ttype:CONST},{input:"\\leq",tag:"mo",output:"\u2264",ttype:CONST},{input:"\\leqslant",tag:"mo",output:"\u2264",ttype:CONST},{input:"\\ge",tag:"mo",output:"\u2265",ttype:CONST},{input:"\\geq",tag:"mo",output:"\u2265",ttype:CONST},{input:"\\geqslant",tag:"mo",output:"\u2265",ttype:CONST},{input:"\\equiv",tag:"mo",output:"\u2261",ttype:CONST},{input:"\\ll",tag:"mo",output:"\u226A",ttype:CONST},{input:"\\gg",tag:"mo",output:"\u226B",ttype:CONST},{input:"\\doteq",tag:"mo",output:"\u2250",ttype:CONST},{input:"\\prec",tag:"mo",output:"\u227A",ttype:CONST},{input:"\\succ",tag:"mo",output:"\u227B",ttype:CONST},{input:"\\preceq",tag:"mo",output:"\u227C",ttype:CONST},{input:"\\succeq",tag:"mo",output:"\u227D",ttype:CONST},{input:"\\subset",tag:"mo",output:"\u2282",ttype:CONST},{input:"\\supset",tag:"mo",output:"\u2283",ttype:CONST},{input:"\\subseteq",tag:"mo",output:"\u2286",ttype:CONST},{input:"\\supseteq",tag:"mo",output:"\u2287",ttype:CONST},{input:"\\sqsubset",tag:"mo",output:"\u228F",ttype:CONST},{input:"\\sqsupset",tag:"mo",output:"\u2290",ttype:CONST},{input:"\\sqsubseteq",tag:"mo",output:"\u2291",ttype:CONST},{input:"\\sqsupseteq",tag:"mo",output:"\u2292",ttype:CONST},{input:"\\sim",tag:"mo",output:"\u223C",ttype:CONST},{input:"\\simeq",tag:"mo",output:"\u2243",ttype:CONST},{input:"\\approx",tag:"mo",output:"\u2248",ttype:CONST},{input:"\\cong",tag:"mo",output:"\u2245",ttype:CONST},{input:"\\Join",tag:"mo",output:"\u22C8",ttype:CONST},{input:"\\bowtie",tag:"mo",output:"\u22C8",ttype:CONST},{input:"\\in",tag:"mo",output:"\u2208",ttype:CONST},{input:"\\ni",tag:"mo",output:"\u220B",ttype:CONST},{input:"\\owns",tag:"mo",output:"\u220B",ttype:CONST},{input:"\\propto",tag:"mo",output:"\u221D",ttype:CONST},{input:"\\vdash",tag:"mo",output:"\u22A2",ttype:CONST},{input:"\\dashv",tag:"mo",output:"\u22A3",ttype:CONST},{input:"\\models",tag:"mo",output:"\u22A8",ttype:CONST},{input:"\\perp",tag:"mo",output:"\u22A5",ttype:CONST},{input:"\\smile",tag:"mo",output:"\u2323",ttype:CONST},{input:"\\frown",tag:"mo",output:"\u2322",ttype:CONST},{input:"\\asymp",tag:"mo",output:"\u224D",ttype:CONST},{input:"\\notin",tag:"mo",output:"\u2209",ttype:CONST},{input:"\\begin{eqnarray}",output:"X",ttype:MATRIX,invisible:true},{input:"\\begin{array}",output:"X",ttype:MATRIX,invisible:true},{input:"\\\\",output:"}&{",ttype:DEFINITION},{input:"\\end{eqnarray}",output:"}}",ttype:DEFINITION},{input:"\\end{array}",output:"}}",ttype:DEFINITION},{input:"\\big",tag:"mo",output:"X",atval:"1.2",ieval:"2.2",ttype:BIG},{input:"\\Big",tag:"mo",output:"X",atval:"1.6",ieval:"2.6",ttype:BIG},{input:"\\bigg",tag:"mo",output:"X",atval:"2.2",ieval:"3.2",ttype:BIG},{input:"\\Bigg",tag:"mo",output:"X",atval:"2.9",ieval:"3.9",ttype:BIG},{input:"\\left",tag:"mo",output:"X",ttype:LEFTBRACKET},{input:"\\right",tag:"mo",output:"X",ttype:RIGHTBRACKET},{input:"{",output:"{",ttype:LEFTBRACKET,invisible:true},{input:"}",output:"}",ttype:RIGHTBRACKET,invisible:true},{input:"(",tag:"mo",output:"(",atval:"1",ttype:STRETCHY},{input:"[",tag:"mo",output:"[",atval:"1",ttype:STRETCHY},{input:"\\lbrack",tag:"mo",output:"[",atval:"1",ttype:STRETCHY},{input:"\\{",tag:"mo",output:"{",atval:"1",ttype:STRETCHY},{input:"\\lbrace",tag:"mo",output:"{",atval:"1",ttype:STRETCHY},{input:"\\langle",tag:"mo",output:"\u2329",atval:"1",ttype:STRETCHY},{input:"\\lfloor",tag:"mo",output:"\u230A",atval:"1",ttype:STRETCHY},{input:"\\lceil",tag:"mo",output:"\u2308",atval:"1",ttype:STRETCHY},{input:")",tag:"mo",output:")",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"]",tag:"mo",output:"]",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rbrack",tag:"mo",output:"]",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\}",tag:"mo",output:"}",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rbrace",tag:"mo",output:"}",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rangle",tag:"mo",output:"\u232A",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rfloor",tag:"mo",output:"\u230B",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"\\rceil",tag:"mo",output:"\u2309",rtag:"mi",atval:"1",ttype:STRETCHY},{input:"|",tag:"mo",output:"\u2223",atval:"1",ttype:STRETCHY},{input:"\\|",tag:"mo",output:"\u2225",atval:"1",ttype:STRETCHY},{input:"\\vert",tag:"mo",output:"\u2223",atval:"1",ttype:STRETCHY},{input:"\\Vert",tag:"mo",output:"\u2225",atval:"1",ttype:STRETCHY},{input:"\\mid",tag:"mo",output:"\u2223",atval:"1",ttype:STRETCHY},{input:"\\parallel",tag:"mo",output:"\u2225",atval:"1",ttype:STRETCHY},{input:"/",tag:"mo",output:"/",atval:"1.01",ttype:STRETCHY},{input:"\\backslash",tag:"mo",output:"\u2216",atval:"1",ttype:STRETCHY},{input:"\\setminus",tag:"mo",output:"\\",ttype:CONST},{input:"\\!",tag:"mspace",atname:"width",atval:"-0.167em",ttype:SPACE},{input:"\\,",tag:"mspace",atname:"width",atval:"0.167em",ttype:SPACE},{input:"\\>",tag:"mspace",atname:"width",atval:"0.222em",ttype:SPACE},{input:"\\:",tag:"mspace",atname:"width",atval:"0.222em",ttype:SPACE},{input:"\\;",tag:"mspace",atname:"width",atval:"0.278em",ttype:SPACE},{input:"~",tag:"mspace",atname:"width",atval:"0.333em",ttype:SPACE},{input:"\\quad",tag:"mspace",atname:"width",atval:"1em",ttype:SPACE},{input:"\\qquad",tag:"mspace",atname:"width",atval:"2em",ttype:SPACE},{input:"\\prime",tag:"mo",output:"\u2032",ttype:CONST},{input:"'",tag:"mo",output:"\u02B9",ttype:CONST},{input:"''",tag:"mo",output:"\u02BA",ttype:CONST},{input:"'''",tag:"mo",output:"\u2034",ttype:CONST},{input:"''''",tag:"mo",output:"\u2057",ttype:CONST},{input:"\\ldots",tag:"mo",output:"\u2026",ttype:CONST},{input:"\\cdots",tag:"mo",output:"\u22EF",ttype:CONST},{input:"\\vdots",tag:"mo",output:"\u22EE",ttype:CONST},{input:"\\ddots",tag:"mo",output:"\u22F1",ttype:CONST},{input:"\\forall",tag:"mo",output:"\u2200",ttype:CONST},{input:"\\exists",tag:"mo",output:"\u2203",ttype:CONST},{input:"\\Re",tag:"mo",output:"\u211C",ttype:CONST},{input:"\\Im",tag:"mo",output:"\u2111",ttype:CONST},{input:"\\aleph",tag:"mo",output:"\u2135",ttype:CONST},{input:"\\hbar",tag:"mo",output:"\u210F",ttype:CONST},{input:"\\ell",tag:"mo",output:"\u2113",ttype:CONST},{input:"\\wp",tag:"mo",output:"\u2118",ttype:CONST},{input:"\\emptyset",tag:"mo",output:"\u2205",ttype:CONST},{input:"\\infty",tag:"mo",output:"\u221E",ttype:CONST},{input:"\\surd",tag:"mo",output:"\\sqrt{}",ttype:DEFINITION},{input:"\\partial",tag:"mo",output:"\u2202",ttype:CONST},{input:"\\nabla",tag:"mo",output:"\u2207",ttype:CONST},{input:"\\triangle",tag:"mo",output:"\u25B3",ttype:CONST},{input:"\\therefore",tag:"mo",output:"\u2234",ttype:CONST},{input:"\\angle",tag:"mo",output:"\u2220",ttype:CONST},{input:"\\diamond",tag:"mo",output:"\u22C4",ttype:CONST},{input:"\\Diamond",tag:"mo",output:"\u25C7",ttype:CONST},{input:"\\neg",tag:"mo",output:"\u00AC",ttype:CONST},{input:"\\lnot",tag:"mo",output:"\u00AC",ttype:CONST},{input:"\\bot",tag:"mo",output:"\u22A5",ttype:CONST},{input:"\\top",tag:"mo",output:"\u22A4",ttype:CONST},{input:"\\square",tag:"mo",output:"\u25AB",ttype:CONST},{input:"\\Box",tag:"mo",output:"\u25A1",ttype:CONST},{input:"\\wr",tag:"mo",output:"\u2240",ttype:CONST},{input:"\\arccos",tag:"mi",output:"arccos",ttype:UNARY,func:true},{input:"\\arcsin",tag:"mi",output:"arcsin",ttype:UNARY,func:true},{input:"\\arctan",tag:"mi",output:"arctan",ttype:UNARY,func:true},{input:"\\arg",tag:"mi",output:"arg",ttype:UNARY,func:true},{input:"\\cos",tag:"mi",output:"cos",ttype:UNARY,func:true},{input:"\\cosh",tag:"mi",output:"cosh",ttype:UNARY,func:true},{input:"\\cot",tag:"mi",output:"cot",ttype:UNARY,func:true},{input:"\\coth",tag:"mi",output:"coth",ttype:UNARY,func:true},{input:"\\csc",tag:"mi",output:"csc",ttype:UNARY,func:true},{input:"\\deg",tag:"mi",output:"deg",ttype:UNARY,func:true},{input:"\\det",tag:"mi",output:"det",ttype:UNARY,func:true},{input:"\\dim",tag:"mi",output:"dim",ttype:UNARY,func:true},{input:"\\exp",tag:"mi",output:"exp",ttype:UNARY,func:true},{input:"\\gcd",tag:"mi",output:"gcd",ttype:UNARY,func:true},{input:"\\hom",tag:"mi",output:"hom",ttype:UNARY,func:true},{input:"\\inf",tag:"mo",output:"inf",ttype:UNDEROVER},{input:"\\ker",tag:"mi",output:"ker",ttype:UNARY,func:true},{input:"\\lg",tag:"mi",output:"lg",ttype:UNARY,func:true},{input:"\\lim",tag:"mo",output:"lim",ttype:UNDEROVER},{input:"\\liminf",tag:"mo",output:"liminf",ttype:UNDEROVER},{input:"\\limsup",tag:"mo",output:"limsup",ttype:UNDEROVER},{input:"\\ln",tag:"mi",output:"ln",ttype:UNARY,func:true},{input:"\\log",tag:"mi",output:"log",ttype:UNARY,func:true},{input:"\\max",tag:"mo",output:"max",ttype:UNDEROVER},{input:"\\min",tag:"mo",output:"min",ttype:UNDEROVER},{input:"\\Pr",tag:"mi",output:"Pr",ttype:UNARY,func:true},{input:"\\sec",tag:"mi",output:"sec",ttype:UNARY,func:true},{input:"\\sin",tag:"mi",output:"sin",ttype:UNARY,func:true},{input:"\\sinh",tag:"mi",output:"sinh",ttype:UNARY,func:true},{input:"\\sup",tag:"mo",output:"sup",ttype:UNDEROVER},{input:"\\tan",tag:"mi",output:"tan",ttype:UNARY,func:true},{input:"\\tanh",tag:"mi",output:"tanh",ttype:UNARY,func:true},{input:"\\gets",tag:"mo",output:"\u2190",ttype:CONST},{input:"\\leftarrow",tag:"mo",output:"\u2190",ttype:CONST},{input:"\\to",tag:"mo",output:"\u2192",ttype:CONST},{input:"\\rightarrow",tag:"mo",output:"\u2192",ttype:CONST},{input:"\\leftrightarrow",tag:"mo",output:"\u2194",ttype:CONST},{input:"\\uparrow",tag:"mo",output:"\u2191",ttype:CONST},{input:"\\downarrow",tag:"mo",output:"\u2193",ttype:CONST},{input:"\\updownarrow",tag:"mo",output:"\u2195",ttype:CONST},{input:"\\Leftarrow",tag:"mo",output:"\u21D0",ttype:CONST},{input:"\\Rightarrow",tag:"mo",output:"\u21D2",ttype:CONST},{input:"\\Leftrightarrow",tag:"mo",output:"\u21D4",ttype:CONST},{input:"\\iff",tag:"mo",output:"~\\Longleftrightarrow~",ttype:DEFINITION},{input:"\\Uparrow",tag:"mo",output:"\u21D1",ttype:CONST},{input:"\\Downarrow",tag:"mo",output:"\u21D3",ttype:CONST},{input:"\\Updownarrow",tag:"mo",output:"\u21D5",ttype:CONST},{input:"\\mapsto",tag:"mo",output:"\u21A6",ttype:CONST},{input:"\\longleftarrow",tag:"mo",output:"\u2190",ttype:LONG},{input:"\\longrightarrow",tag:"mo",output:"\u2192",ttype:LONG},{input:"\\longleftrightarrow",tag:"mo",output:"\u2194",ttype:LONG},{input:"\\Longleftarrow",tag:"mo",output:"\u21D0",ttype:LONG},{input:"\\Longrightarrow",tag:"mo",output:"\u21D2",ttype:LONG},{input:"\\Longleftrightarrow",tag:"mo",output:"\u21D4",ttype:LONG},{input:"\\longmapsto",tag:"mo",output:"\u21A6",ttype:CONST},AMsqrt,AMroot,AMfrac,AMover,AMsub,AMsup,AMtext,AMmbox,AMatop,AMchoose,{input:"\\acute",tag:"mover",output:"\u00B4",ttype:UNARY,acc:true},{input:"\\grave",tag:"mover",output:"\u0060",ttype:UNARY,acc:true},{input:"\\breve",tag:"mover",output:"\u02D8",ttype:UNARY,acc:true},{input:"\\check",tag:"mover",output:"\u02C7",ttype:UNARY,acc:true},{input:"\\dot",tag:"mover",output:".",ttype:UNARY,acc:true},{input:"\\ddot",tag:"mover",output:"..",ttype:UNARY,acc:true},{input:"\\mathring",tag:"mover",output:"\u00B0",ttype:UNARY,acc:true},{input:"\\vec",tag:"mover",output:"\u20D7",ttype:UNARY,acc:true},{input:"\\overrightarrow",tag:"mover",output:"\u20D7",ttype:UNARY,acc:true},{input:"\\overleftarrow",tag:"mover",output:"\u20D6",ttype:UNARY,acc:true},{input:"\\hat",tag:"mover",output:"\u005E",ttype:UNARY,acc:true},{input:"\\widehat",tag:"mover",output:"\u0302",ttype:UNARY,acc:true},{input:"\\tilde",tag:"mover",output:"~",ttype:UNARY,acc:true},{input:"\\widetilde",tag:"mover",output:"\u02DC",ttype:UNARY,acc:true},{input:"\\bar",tag:"mover",output:"\u203E",ttype:UNARY,acc:true},{input:"\\overbrace",tag:"mover",output:"\uFE37",ttype:UNARY,acc:true},{input:"\\overbracket",tag:"mover",output:"\u23B4",ttype:UNARY,acc:true},{input:"\\overline",tag:"mover",output:"\u00AF",ttype:UNARY,acc:true},{input:"\\underbrace",tag:"munder",output:"\uFE38",ttype:UNARY,acc:true},{input:"\\underbracket",tag:"munder",output:"\u23B5",ttype:UNARY,acc:true},{input:"\\underline",tag:"munder",output:"\u00AF",ttype:UNARY,acc:true},{input:"\\displaystyle",tag:"mstyle",atname:"displaystyle",atval:"true",ttype:UNARY},{input:"\\textstyle",tag:"mstyle",atname:"displaystyle",atval:"false",ttype:UNARY},{input:"\\scriptstyle",tag:"mstyle",atname:"scriptlevel",atval:"1",ttype:UNARY},{input:"\\scriptscriptstyle",tag:"mstyle",atname:"scriptlevel",atval:"2",ttype:UNARY},{input:"\\textrm",tag:"mstyle",output:"\\mathrm",ttype:DEFINITION},{input:"\\mathbf",tag:"mstyle",atname:"mathvariant",atval:"bold",ttype:UNARY},{input:"\\textbf",tag:"mstyle",atname:"mathvariant",atval:"bold",ttype:UNARY},{input:"\\mathit",tag:"mstyle",atname:"mathvariant",atval:"italic",ttype:UNARY},{input:"\\textit",tag:"mstyle",atname:"mathvariant",atval:"italic",ttype:UNARY},{input:"\\mathtt",tag:"mstyle",atname:"mathvariant",atval:"monospace",ttype:UNARY},{input:"\\texttt",tag:"mstyle",atname:"mathvariant",atval:"monospace",ttype:UNARY},{input:"\\mathsf",tag:"mstyle",atname:"mathvariant",atval:"sans-serif",ttype:UNARY},{input:"\\mathbb",tag:"mstyle",atname:"mathvariant",atval:"double-struck",ttype:UNARY,codes:AMbbb},{input:"\\mathcal",tag:"mstyle",atname:"mathvariant",atval:"script",ttype:UNARY,codes:AMcal},{input:"\\mathfrak",tag:"mstyle",atname:"mathvariant",atval:"fraktur",ttype:UNARY,codes:AMfrk},{input:"\\textcolor",tag:"mstyle",atname:"mathvariant",atval:"mathcolor",ttype:BINARY},{input:"\\colorbox",tag:"mstyle",atname:"mathvariant",atval:"background",ttype:BINARY}];function compareNames(s1,s2){if(s1.input>s2.input)return 1
  else return-1;}
  var AMnames=[];function AMinitSymbols(){AMsymbols.sort(compareNames);for(i=0;i<AMsymbols.length;i++)AMnames[i]=AMsymbols[i].input;}
  var AMmathml="http://www.w3.org/1998/Math/MathML";function AMcreateElementMathML(t){if(isIE)return document.createElement("m:"+t);else return document.createElementNS(AMmathml,t);}
  function AMcreateMmlNode(t,frag){if(isIE)var node=document.createElement("m:"+t);else var node=document.createElementNS(AMmathml,t);node.appendChild(frag);return node;}
  function newcommand(oldstr,newstr){AMsymbols=AMsymbols.concat([{input:oldstr,tag:"mo",output:newstr,ttype:DEFINITION}]);}
  function AMremoveCharsAndBlanks(str,n){var st;st=str.slice(n);for(var i=0;i<st.length&&st.charCodeAt(i)<=32;i=i+1);return st.slice(i);}
  function AMposition(arr,str,n){if(n==0){var h,m;n=-1;h=arr.length;while(n+1<h){m=(n+h)>>1;if(arr[m]<str)n=m;else h=m;}
  return h;}else
  for(var i=n;i<arr.length&&arr[i]<str;i++);return i;}
  function AMgetSymbol(str){var k=0;var j=0;var mk;var st;var tagst;var match="";var more=true;for(var i=1;i<=str.length&&more;i++){st=str.slice(0,i);j=k;k=AMposition(AMnames,st,j);if(k<AMnames.length&&str.slice(0,AMnames[k].length)==AMnames[k]){match=AMnames[k];mk=k;i=match.length;}
  more=k<AMnames.length&&str.slice(0,AMnames[k].length)>=AMnames[k];}
  AMpreviousSymbol=AMcurrentSymbol;if(match!=""){AMcurrentSymbol=AMsymbols[mk].ttype;return AMsymbols[mk];}
  AMcurrentSymbol=CONST;k=1;st=str.slice(0,1);if("0"<=st&&st<="9")tagst="mn";else tagst=(("A">st||st>"Z")&&("a">st||st>"z")?"mo":"mi");return{input:st,tag:tagst,output:st,ttype:CONST};}
  var AMpreviousSymbol,AMcurrentSymbol;function AMparseSexpr(str){var symbol,node,result,result2,i,st,newFrag=document.createDocumentFragment();str=AMremoveCharsAndBlanks(str,0);symbol=AMgetSymbol(str);if(symbol==null||symbol.ttype==RIGHTBRACKET)
  return[null,str,null];if(symbol.ttype==DEFINITION){str=symbol.output+AMremoveCharsAndBlanks(str,symbol.input.length);symbol=AMgetSymbol(str);if(symbol==null||symbol.ttype==RIGHTBRACKET)
  return[null,str,null];}
  str=AMremoveCharsAndBlanks(str,symbol.input.length);switch(symbol.ttype){case SPACE:node=AMcreateElementMathML(symbol.tag);node.setAttribute(symbol.atname,symbol.atval);return[node,str,symbol.tag];case UNDEROVER:if(isIE){if(symbol.input.substr(0,4)=="\\big"){str="\\"+symbol.input.substr(4)+str;symbol=AMgetSymbol(str);symbol.ttype=UNDEROVER;str=AMremoveCharsAndBlanks(str,symbol.input.length);}}
  return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str,symbol.tag];case CONST:var output=symbol.output;if(isIE){if(symbol.input=="'")
  output="\u2032";else if(symbol.input=="''")
  output="\u2033";else if(symbol.input=="'''")
  output="\u2033\u2032";else if(symbol.input=="''''")
  output="\u2033\u2033";else if(symbol.input=="\\square")
  output="\u25A1";else if(symbol.input.substr(0,5)=="\\frac"){var denom=symbol.input.substr(6,1);if(denom=="5"||denom=="6"){str=symbol.input.replace(/\\frac/,"\\frac ")+str;return[node,str,symbol.tag];}}}
  node=AMcreateMmlNode(symbol.tag,document.createTextNode(output));return[node,str,symbol.tag];case LONG:node=AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));node.setAttribute("minsize","1.5");node.setAttribute("maxsize","1.5");node=AMcreateMmlNode("mover",node);node.appendChild(AMcreateElementMathML("mspace"));return[node,str,symbol.tag];case STRETCHY:if(isIE&&symbol.input=="\\backslash")
  symbol.output="\\";node=AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));if(symbol.input=="|"||symbol.input=="\\vert"||symbol.input=="\\|"||symbol.input=="\\Vert"){node.setAttribute("lspace","0em");node.setAttribute("rspace","0em");}
  node.setAttribute("maxsize",symbol.atval);if(symbol.rtag!=null)
  return[node,str,symbol.rtag];else
  return[node,str,symbol.tag];case BIG:var atval=symbol.atval;if(isIE)
  atval=symbol.ieval;symbol=AMgetSymbol(str);if(symbol==null)
  return[null,str,null];str=AMremoveCharsAndBlanks(str,symbol.input.length);node=AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));if(isIE){var space=AMcreateElementMathML("mspace");space.setAttribute("height",atval+"ex");node=AMcreateMmlNode("mrow",node);node.appendChild(space);}else{node.setAttribute("minsize",atval);node.setAttribute("maxsize",atval);}
  return[node,str,symbol.tag];case LEFTBRACKET:if(symbol.input=="\\left"){symbol=AMgetSymbol(str);if(symbol!=null){if(symbol.input==".")
  symbol.invisible=true;str=AMremoveCharsAndBlanks(str,symbol.input.length);}}
  result=AMparseExpr(str,true,false);if(symbol==null||(typeof symbol.invisible=="boolean"&&symbol.invisible))
  node=AMcreateMmlNode("mrow",result[0]);else{node=AMcreateMmlNode("mo",document.createTextNode(symbol.output));node=AMcreateMmlNode("mrow",node);node.appendChild(result[0]);}
  return[node,result[1],result[2]];case MATRIX:if(symbol.input=="\\begin{array}"){var mask="";symbol=AMgetSymbol(str);str=AMremoveCharsAndBlanks(str,0);if(symbol==null)
  mask="l";else{str=AMremoveCharsAndBlanks(str,symbol.input.length);if(symbol.input!="{")
  mask="l";else do{symbol=AMgetSymbol(str);if(symbol!=null){str=AMremoveCharsAndBlanks(str,symbol.input.length);if(symbol.input!="}")
  mask=mask+symbol.input;}}while(symbol!=null&&symbol.input!=""&&symbol.input!="}");}
  result=AMparseExpr("{"+str,true,true);node=AMcreateMmlNode("mtable",result[0]);mask=mask.replace(/l/g,"left ");mask=mask.replace(/r/g,"right ");mask=mask.replace(/c/g,"center ");node.setAttribute("columnalign",mask);node.setAttribute("displaystyle","false");if(isIE)
  return[node,result[1],null];var lspace=AMcreateElementMathML("mspace");lspace.setAttribute("width","0.167em");var rspace=AMcreateElementMathML("mspace");rspace.setAttribute("width","0.167em");var node1=AMcreateMmlNode("mrow",lspace);node1.appendChild(node);node1.appendChild(rspace);return[node1,result[1],null];}else{result=AMparseExpr("{"+str,true,true);node=AMcreateMmlNode("mtable",result[0]);if(isIE)
  node.setAttribute("columnspacing","0.25em");else
  node.setAttribute("columnspacing","0.167em");node.setAttribute("columnalign","right center left");node.setAttribute("displaystyle","true");node=AMcreateMmlNode("mrow",node);return[node,result[1],null];}
  case TEXT:if(str.charAt(0)=="{")i=str.indexOf("}");else i=0;if(i==-1)
  i=str.length;st=str.slice(1,i);if(st.charAt(0)==" "){node=AMcreateElementMathML("mspace");node.setAttribute("width","0.33em");newFrag.appendChild(node);}
  newFrag.appendChild(AMcreateMmlNode(symbol.tag,document.createTextNode(st)));if(st.charAt(st.length-1)==" "){node=AMcreateElementMathML("mspace");node.setAttribute("width","0.33em");newFrag.appendChild(node);}
  str=AMremoveCharsAndBlanks(str,i+1);return[AMcreateMmlNode("mrow",newFrag),str,null];case UNARY:result=AMparseSexpr(str);if(result[0]==null)return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str];if(typeof symbol.func=="boolean"&&symbol.func){st=str.charAt(0);if(st=="^"||st=="_"||st==","){return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str,symbol.tag];}else{node=AMcreateMmlNode("mrow",AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)));if(isIE){var space=AMcreateElementMathML("mspace");space.setAttribute("width","0.167em");node.appendChild(space);}
  node.appendChild(result[0]);return[node,result[1],symbol.tag];}}
  if(symbol.input=="\\sqrt"){if(isIE){var space=AMcreateElementMathML("mspace");space.setAttribute("height","1.2ex");space.setAttribute("width","0em");node=AMcreateMmlNode(symbol.tag,result[0])
  node.appendChild(space);return[node,result[1],symbol.tag];}else
  return[AMcreateMmlNode(symbol.tag,result[0]),result[1],symbol.tag];}else if(typeof symbol.acc=="boolean"&&symbol.acc){node=AMcreateMmlNode(symbol.tag,result[0]);var output=symbol.output;if(isIE){if(symbol.input=="\\hat")
  output="\u0302";else if(symbol.input=="\\widehat")
  output="\u005E";else if(symbol.input=="\\bar")
  output="\u00AF";else if(symbol.input=="\\grave")
  output="\u0300";else if(symbol.input=="\\tilde")
  output="\u0303";}
  var node1=AMcreateMmlNode("mo",document.createTextNode(output));if(symbol.input=="\\vec"||symbol.input=="\\check")
  node1.setAttribute("maxsize","1.2");if(isIE&&symbol.input=="\\bar")
  node1.setAttribute("maxsize","0.5");if(symbol.input=="\\underbrace"||symbol.input=="\\underline")
  node1.setAttribute("accentunder","true");else
  node1.setAttribute("accent","true");node.appendChild(node1);if(symbol.input=="\\overbrace"||symbol.input=="\\underbrace")
  node.ttype=UNDEROVER;return[node,result[1],symbol.tag];}else{if(!isIE&&typeof symbol.codes!="undefined"){for(i=0;i<result[0].childNodes.length;i++)
  if(result[0].childNodes[i].nodeName=="mi"||result[0].nodeName=="mi"){st=(result[0].nodeName=="mi"?result[0].firstChild.nodeValue:result[0].childNodes[i].firstChild.nodeValue);var newst=[];for(var j=0;j<st.length;j++)
  if(st.charCodeAt(j)>64&&st.charCodeAt(j)<91)newst=newst+
  String.fromCharCode(symbol.codes[st.charCodeAt(j)-65]);else newst=newst+st.charAt(j);if(result[0].nodeName=="mi")
  result[0]=AMcreateElementMathML("mo").appendChild(document.createTextNode(newst));else result[0].replaceChild(AMcreateElementMathML("mo").appendChild(document.createTextNode(newst)),result[0].childNodes[i]);}}
  node=AMcreateMmlNode(symbol.tag,result[0]);node.setAttribute(symbol.atname,symbol.atval);if(symbol.input=="\\scriptstyle"||symbol.input=="\\scriptscriptstyle")
  node.setAttribute("displaystyle","false");return[node,result[1],symbol.tag];}
  case BINARY:result=AMparseSexpr(str);if(result[0]==null)return[AMcreateMmlNode("mo",document.createTextNode(symbol.input)),str,null];result2=AMparseSexpr(result[1]);if(result2[0]==null)return[AMcreateMmlNode("mo",document.createTextNode(symbol.input)),str,null];if(symbol.input=="\\textcolor"||symbol.input=="\\colorbox"){var tclr=str.match(/\{\s*([#\w]+)\s*\}/);str=str.replace(/\{\s*[#\w]+\s*\}/,"");if(tclr!=null){if(IsColorName.test(tclr[1].toLowerCase())){tclr=LaTeXColor[tclr[1].toLowerCase()];}else{tclr=tclr[1];}
  node=AMcreateElementMathML("mstyle");node.setAttribute(symbol.atval,tclr);node.appendChild(result2[0]);return[node,result2[1],symbol.tag];}}
  if(symbol.input=="\\root"||symbol.input=="\\stackrel")newFrag.appendChild(result2[0]);newFrag.appendChild(result[0]);if(symbol.input=="\\frac")newFrag.appendChild(result2[0]);return[AMcreateMmlNode(symbol.tag,newFrag),result2[1],symbol.tag];case INFIX:str=AMremoveCharsAndBlanks(str,symbol.input.length);return[AMcreateMmlNode("mo",document.createTextNode(symbol.output)),str,symbol.tag];default:return[AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)),str,symbol.tag];}}
  function AMparseIexpr(str){var symbol,sym1,sym2,node,result,tag,underover;str=AMremoveCharsAndBlanks(str,0);sym1=AMgetSymbol(str);result=AMparseSexpr(str);node=result[0];str=result[1];tag=result[2];symbol=AMgetSymbol(str);if(symbol.ttype==INFIX){str=AMremoveCharsAndBlanks(str,symbol.input.length);result=AMparseSexpr(str);if(result[0]==null)
  result[0]=AMcreateMmlNode("mo",document.createTextNode("\u25A1"));str=result[1];tag=result[2];if(symbol.input=="_"||symbol.input=="^"){sym2=AMgetSymbol(str);tag=null;underover=((sym1.ttype==UNDEROVER)||(node.ttype==UNDEROVER));if(symbol.input=="_"&&sym2.input=="^"){str=AMremoveCharsAndBlanks(str,sym2.input.length);var res2=AMparseSexpr(str);str=res2[1];tag=res2[2];node=AMcreateMmlNode((underover?"munderover":"msubsup"),node);node.appendChild(result[0]);node.appendChild(res2[0]);}else if(symbol.input=="_"){node=AMcreateMmlNode((underover?"munder":"msub"),node);node.appendChild(result[0]);}else{node=AMcreateMmlNode((underover?"mover":"msup"),node);node.appendChild(result[0]);}
  node=AMcreateMmlNode("mrow",node);}else{node=AMcreateMmlNode(symbol.tag,node);if(symbol.input=="\\atop"||symbol.input=="\\choose")
  node.setAttribute("linethickness","0ex");node.appendChild(result[0]);if(symbol.input=="\\choose")
  node=AMcreateMmlNode("mfenced",node);}}
  return[node,str,tag];}
  function AMparseExpr(str,rightbracket,matrix){var symbol,node,result,i,tag,newFrag=document.createDocumentFragment();do{str=AMremoveCharsAndBlanks(str,0);result=AMparseIexpr(str);node=result[0];str=result[1];tag=result[2];symbol=AMgetSymbol(str);if(node!=undefined){if((tag=="mn"||tag=="mi")&&symbol!=null&&typeof symbol.func=="boolean"&&symbol.func){var space=AMcreateElementMathML("mspace");space.setAttribute("width","0.167em");node=AMcreateMmlNode("mrow",node);node.appendChild(space);}
  newFrag.appendChild(node);}}while((symbol.ttype!=RIGHTBRACKET)&&symbol!=null&&symbol.output!="");tag=null;if(symbol.ttype==RIGHTBRACKET){if(symbol.input=="\\right"){str=AMremoveCharsAndBlanks(str,symbol.input.length);symbol=AMgetSymbol(str);if(symbol!=null&&symbol.input==".")
  symbol.invisible=true;if(symbol!=null)
  tag=symbol.rtag;}
  if(symbol!=null)
  str=AMremoveCharsAndBlanks(str,symbol.input.length);var len=newFrag.childNodes.length;if(matrix&&len>0&&newFrag.childNodes[len-1].nodeName=="mrow"&&len>1&&newFrag.childNodes[len-2].nodeName=="mo"&&newFrag.childNodes[len-2].firstChild.nodeValue=="&"){var pos=[];var m=newFrag.childNodes.length;for(i=0;matrix&&i<m;i=i+2){pos[i]=[];node=newFrag.childNodes[i];for(var j=0;j<node.childNodes.length;j++)
  if(node.childNodes[j].firstChild.nodeValue=="&")
  pos[i][pos[i].length]=j;}
  var row,frag,n,k,table=document.createDocumentFragment();for(i=0;i<m;i=i+2){row=document.createDocumentFragment();frag=document.createDocumentFragment();node=newFrag.firstChild;n=node.childNodes.length;k=0;for(j=0;j<n;j++){if(typeof pos[i][k]!="undefined"&&j==pos[i][k]){node.removeChild(node.firstChild);row.appendChild(AMcreateMmlNode("mtd",frag));k++;}else frag.appendChild(node.firstChild);}
  row.appendChild(AMcreateMmlNode("mtd",frag));if(newFrag.childNodes.length>2){newFrag.removeChild(newFrag.firstChild);newFrag.removeChild(newFrag.firstChild);}
  table.appendChild(AMcreateMmlNode("mtr",row));}
  return[table,str];}
  if(typeof symbol.invisible!="boolean"||!symbol.invisible){node=AMcreateMmlNode("mo",document.createTextNode(symbol.output));newFrag.appendChild(node);}}
  return[newFrag,str,tag];}
  function AMparseMath(str){var result,node=AMcreateElementMathML("mstyle");var cclr=str.match(/\\color\s*\{\s*([#\w]+)\s*\}/);str=str.replace(/\\color\s*\{\s*[#\w]+\s*\}/g,"");if(cclr!=null){if(IsColorName.test(cclr[1].toLowerCase())){cclr=LaTeXColor[cclr[1].toLowerCase()];}else{cclr=cclr[1];}
  node.setAttribute("mathcolor",cclr);}else{if(mathcolor!="")node.setAttribute("mathcolor",mathcolor);};if(mathfontfamily!="")node.setAttribute("fontfamily",mathfontfamily);node.appendChild(AMparseExpr(str.replace(/^\s+/g,""),false,false)[0]);node=AMcreateMmlNode("math",node);if(showasciiformulaonhover)
  node.setAttribute("title",str.replace(/\s+/g," "));if(false){var fnode=AMcreateElementXHTML("font");fnode.setAttribute("face",mathfontfamily);fnode.appendChild(node);return fnode;}
  return node;}
  function AMstrarr2docFrag(arr,linebreaks){var newFrag=document.createDocumentFragment();var expr=false;for(var i=0;i<arr.length;i++){if(expr)newFrag.appendChild(AMparseMath(arr[i]));else{var arri=(linebreaks?arr[i].split("\n\n"):[arr[i]]);newFrag.appendChild(AMcreateElementXHTML("span").appendChild(document.createTextNode(arri[0])));for(var j=1;j<arri.length;j++){newFrag.appendChild(AMcreateElementXHTML("p"));newFrag.appendChild(AMcreateElementXHTML("span").appendChild(document.createTextNode(arri[j])));}}
  expr=!expr;}
  return newFrag;}
  function AMprocessNodeR(n,linebreaks){var mtch,str,arr,frg,i;if(n.childNodes.length==0){if((n.nodeType!=8||linebreaks)&&n.parentNode.nodeName!="form"&&n.parentNode.nodeName!="FORM"&&n.parentNode.nodeName!="textarea"&&n.parentNode.nodeName!="TEXTAREA"&&n.parentNode.nodeName!="pre"&&n.parentNode.nodeName!="PRE"){str=n.nodeValue;if(!(str==null)){str=str.replace(/\r\n\r\n/g,"\n\n");str=str.replace(/\x20+/g," ");str=str.replace(/\s*\r\n/g," ");mtch=(str.indexOf("\$")==-1?false:true);str=str.replace(/([^\\])\$/g,"$1 \$");str=str.replace(/^\$/," \$");arr=str.split(" \$");for(i=0;i<arr.length;i++)
  arr[i]=arr[i].replace(/\\\$/g,"\$");if(arr.length>1||mtch){if(checkForMathML){checkForMathML=false;var nd=AMisMathMLavailable();AMnoMathML=nd!=null;if(AMnoMathML&&notifyIfNoMathML)
  if(alertIfNoMathML)
  alert("To view the ASCIIMathML notation use Internet Explorer 6 +\nMathPlayer (free from www.dessci.com)\nor Firefox/Mozilla/Netscape");else AMbody.insertBefore(nd,AMbody.childNodes[0]);}
  if(!AMnoMathML){frg=AMstrarr2docFrag(arr,n.nodeType==8);var len=frg.childNodes.length;n.parentNode.replaceChild(frg,n);return len-1;}else return 0;}}}else return 0;}else if(n.nodeName!="math"){for(i=0;i<n.childNodes.length;i++)
  i+=AMprocessNodeR(n.childNodes[i],linebreaks);}
  return 0;}
  function AMprocessNode(n,linebreaks,spanclassAM){var frag,st;if(spanclassAM!=null){frag=document.getElementsByTagName("span")
  for(var i=0;i<frag.length;i++)
  if(frag[i].className=="AM")
  AMprocessNodeR(frag[i],linebreaks);}else{try{st=n.innerHTML;}catch(err){}
  if(st==null||st.indexOf("\$")!=-1)
  AMprocessNodeR(n,linebreaks);}
  if(isIE){frag=document.getElementsByTagName('math');for(var i=0;i<frag.length;i++)frag[i].update()}}
  var inAppendix=false;var sectionCntr=0;var IEcommentWarning=true;var biblist=[];var bibcntr=0;var LaTeXCounter=[];LaTeXCounter["definition"]=0;LaTeXCounter["proposition"]=0;LaTeXCounter["lemma"]=0;LaTeXCounter["theorem"]=0;LaTeXCounter["corollary"]=0;LaTeXCounter["example"]=0;LaTeXCounter["exercise"]=0;LaTeXCounter["subsection"]=0;LaTeXCounter["subsubsection"]=0;LaTeXCounter["figure"]=0;LaTeXCounter["equation"]=0;LaTeXCounter["table"]=0;var LaTeXColor=[];LaTeXColor["greenyellow"]="#D9FF4F";LaTeXColor["yellow"]="#FFFF00";LaTeXColor["goldenrod"]="#FFE529";LaTeXColor["dandelion"]="#FFB529";LaTeXColor["apricot"]="#FFAD7A";LaTeXColor["peach"]="#FF804D";LaTeXColor["melon"]="#FF8A80";LaTeXColor["yelloworange"]="#FF9400";LaTeXColor["orange"]="#FF6321";LaTeXColor["burntorange"]="#FF7D00";LaTeXColor["bittersweet"]="#C20300";LaTeXColor["redorange"]="#FF3B21";LaTeXColor["mahogany"]="#A60000";LaTeXColor["maroon"]="#AD0000";LaTeXColor["brickred"]="#B80000";LaTeXColor["red"]="#FF0000";LaTeXColor["orangered"]="#FF0080";LaTeXColor["rubinered"]="#FF00DE";LaTeXColor["wildstrawberry"]="#FF0A9C";LaTeXColor["salmon"]="#FF789E";LaTeXColor["carnationpink"]="#FF5EFF";LaTeXColor["magenta"]="#FF00FF";LaTeXColor["violetred"]="#FF30FF";LaTeXColor["rhodamine"]="#FF2EFF";LaTeXColor["mulberry"]="#A314FA";LaTeXColor["redviolet"]="#9600A8";LaTeXColor["fuchsia"]="#7303EB";LaTeXColor["lavender"]="#FF85FF";LaTeXColor["thistle"]="#E069FF";LaTeXColor["orchid"]="#AD5CFF";LaTeXColor["darkorchid"]="#9933CC";LaTeXColor["purple"]="#8C24FF";LaTeXColor["plum"]="#8000FF";LaTeXColor["violet"]="#361FFF";LaTeXColor["royalpurple"]="#401AFF";LaTeXColor["blueviolet"]="#1A0DF5";LaTeXColor["periwinkle"]="#6E73FF";LaTeXColor["cadetblue"]="#616EC4";LaTeXColor["cornflowerblue"]="#59DEFF";LaTeXColor["midnightblue"]="#007091";LaTeXColor["navyblue"]="#0F75FF";LaTeXColor["royalblue"]="#0080FF";LaTeXColor["blue"]="#0000FF";LaTeXColor["cerulean"]="#0FE3FF";LaTeXColor["cyan"]="#00FFFF";LaTeXColor["processblue"]="#0AFFFF";LaTeXColor["skyblue"]="#61FFE0";LaTeXColor["turquoise"]="#26FFCC";LaTeXColor["tealblue"]="#1FFAA3";LaTeXColor["aquamarine"]="#2EFFB2";LaTeXColor["bluegreen"]="#26FFAB";LaTeXColor["emerald"]="#00FF80";LaTeXColor["junglegreen"]="#03FF7A";LaTeXColor["seagreen"]="#4FFF80";LaTeXColor["green"]="#00FF00";LaTeXColor["forestgreen"]="#00E000";LaTeXColor["pinegreen"]="#00BF29";LaTeXColor["limegreen"]="#80FF00";LaTeXColor["yellowgreen"]="#8FFF42";LaTeXColor["springgreen"]="#BDFF3D";LaTeXColor["olivegreen"]="#009900";LaTeXColor["rawsienna"]="#8C0000";LaTeXColor["sepia"]="#4D0000";LaTeXColor["brown"]="#660000";LaTeXColor["tan"]="#DB9470";LaTeXColor["gray"]="#808080";LaTeXColor["grey"]="#808080";LaTeXColor["black"]="#000000";LaTeXColor["white"]="#FFFFFF";var IsColorName=/^(?:greenyellow|yellow|goldenrod|dandelion|apricot|peach|melon|yelloworange|orange|burntorange|bittersweet|redorange|mahogany|maroon|brickred|red|orangered|rubinered|wildstrawberry|salmon|carnationpink|magenta|violetred|rhodamine|mulberry|redviolet|fuchsia|lavender|thistle|orchid|darkorchid|purple|plum|violet|royalpurple|blueviolet|periwinkle|cadetblue|cornflowerblue|midnightblue|navyblue|royalblue|blue|cerulean|cyan|processblue|skyblue|turquoise|tealblue|aquamarine|bluegreen|emerald|junglegreen|seagreen|green|forestgreen|pinegreen|limegreen|yellowgreen|springgreen|olivegreen|rawsienna|sepia|brown|tan|gray|grey|black|white)$/;var IsCounter=/^(?:definition|proposition|lemma|theorem|corollary|example|exercise|subsection|subsubsection|figure|equation|table)$/;var IsLaTeXElement=/^(?:displayequation|title|author|address|date|abstract|keyword|section|subsection|subsubsection|ref|cite|thebibliography|definition|proposition|lemma|theorem|corollary|example|exercise|itemize|enumerate|enddefinition|endproposition|endlemma|endtheorem|endcorollary|endexample|endexercise|enditemize|endenumerate|LaTeXMathMLlabel|LaTeXMathML|smallskip|medskip|bigskip|quote|quotation|endquote|endquotation|center|endcenter|description|enddescription|inlinemath)$/;var IsTextOnlyArea=/^(?:form|textarea|pre)$/i;var tableid=0;function makeNumberString(cntr){if(sectionCntr>0){if(inAppendix){return"A"+sectionCntr+"."+cntr;}else{return sectionCntr+"."+cntr;}}else{return""+cntr;}};function LaTeXpreProcess(thebody){var TheBody=thebody;if(TheBody.hasChildNodes()){if(!(IsLaTeXElement.test(TheBody.className)))
  {for(var i=0;i<TheBody.childNodes.length;i++){LaTeXpreProcess(TheBody.childNodes[i])}}}
  else{if(TheBody.nodeType==3&&!(IsTextOnlyArea.test(TheBody.parentNode.nodeName)))
  {var str=TheBody.nodeValue;if(!(str==null)){str=str.replace(/\\%/g,"<per>");str=str.replace(/%[^\n]*(?=\n)/g,"");str=str.replace(/%[^\r]*(?=\r)/g,"");str=str.replace(/%[^\n]*$/,"")
  if(isIE&&str.match(/%/g)!=null&&IEcommentWarning){alert("Comments may not have parsed properly.  Try putting in <pre class='LaTeX><div>..</div></pre> structure.");IEcommentWarning=false;}
  str=str.replace(/<per>/g,"%");if(str.match(/XXX[\s\S]*/)!=null){var tmp=str.match(/XXX[\s\S]*/)[0];var tmpstr=tmp.charCodeAt(7)+"::"+tmp.charCodeAt(8)+"::"+tmp.charCodeAt(9)+"::"+tmp.charCodeAt(10)+"::"+tmp.charCodeAt(11)+"::"+tmp.charCodeAt(12)+"::"+tmp.charCodeAt(13);alert(tmpstr);}
  str=str.replace(/([^\\])\\(\s)/g,"$1\u00A0$2");str=str.replace(/\\quad/g,"\u2001");str=str.replace(/\\qquad/g,"\u2001\u2001");str=str.replace(/\\enspace/g,"\u2002");str=str.replace(/\\;/g,"\u2004");str=str.replace(/\\:/g,"\u2005");str=str.replace(/\\,/g,"\u2006");str=str.replace(/\\thinspace/g,"\u200A");str=str.replace(/([^\\])~/g,"$1\u00A0");str=str.replace(/\\~/g,"~");str=str.replace(/\\\[/g," <DEQ> $\\displaystyle{");str=str.replace(/\\\]/g,"}$ <DEQ> ");str=str.replace(/\$\$/g,"${$<DEQ>$}$");str=str.replace(/\\begin\s*\{\s*array\s*\}/g,"\\begin{array}");str=str.replace(/\\end\s*\{\s*array\s*\}/g,"\\end{array}");str=str.replace(/\\begin\s*\{\s*eqnarray\s*\}/g,"  <DEQ>eqno$\\begin{eqnarray}");str=str.replace(/\\end\s*\{\s*eqnarray\s*\}/g,"\\end{eqnarray}$<DEQ>  ");str=str.replace(/\\begin\s*\{\s*eqnarray\*\s*\}/g,"  <DEQ>$\\begin{eqnarray}");str=str.replace(/\\end\s*\{\s*eqnarray\*\s*\}/g,"\\end{eqnarray}$<DEQ>  ");str=str.replace(/\\begin\s*\{\s*displaymath\s*\}/g," <DEQ> $\\displaystyle{");str=str.replace(/\\end\s*\{\s*displaymath\s*\}/g,"}$ <DEQ> ");str=str.replace(/\\begin\s*\{\s*equation\s*\*\s*\}/g," <DEQ> $\\displaystyle{");str=str.replace(/\\end\s*\{\s*equation\s*\*\s*\}/g,"}$ <DEQ> ");str=str.replace(/\\begin\s*\{\s*equation\s*\}/g," <DEQ>eqno$\\displaystyle{");str=str.replace(/\\end\s*\{\s*equation\s*\}/g,"}$ <DEQ> ");str=str.split("<DEQ>");var newFrag=document.createDocumentFragment();for(var i=0;i<str.length;i++){if(i%2){var DEQtable=document.createElement("table");DEQtable.className='displayequation';var DEQtbody=document.createElement("tbody");var DEQtr=document.createElement("tr");var DEQtdeq=document.createElement("td");DEQtdeq.className='eq';str[i]=str[i].replace(/\$\}\$/g,"$\\displaystyle{");str[i]=str[i].replace(/\$\{\$/g,"}");var lbl=str[i].match(/\\label\s*\{\s*(\w+)\s*\}/);var ISeqno=str[i].match(/^eqno/);str[i]=str[i].replace(/^eqno/," ");str[i]=str[i].replace(/\\label\s*\{\s*\w+\s*\}/," ");DEQtdeq.appendChild(document.createTextNode(str[i]));DEQtr.appendChild(DEQtdeq);str[i]=str[i].replace(/\\nonumber/g,"");if(ISeqno!=null||lbl!=null){var DEQtdno=document.createElement("td");DEQtdno.className='eqno';LaTeXCounter["equation"]++;var eqnoString=makeNumberString(LaTeXCounter["equation"]);var DEQanchor=document.createElement("a");if(lbl!=null){DEQanchor.id=lbl[1]};DEQanchor.className="eqno";var anchorSpan=document.createElement("span");anchorSpan.className="eqno";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(eqnoString));DEQanchor.appendChild(anchorSpan);DEQtdno.appendChild(DEQanchor);var DEQspan=document.createElement("span");DEQspan.className="eqno";DEQspan.appendChild(document.createTextNode("("+eqnoString+")"));DEQtdno.appendChild(DEQspan);DEQtr.appendChild(DEQtdno);}
  DEQtbody.appendChild(DEQtr);DEQtable.appendChild(DEQtbody);newFrag.appendChild(DEQtable);}
  else{str[i]=str[i].replace(/\$\}\$/g,"");str[i]=str[i].replace(/\$\{\$/g,"");str[i]=str[i].replace(/\\maketitle/g,"");str[i]=str[i].replace(/\\begin\s*\{\s*document\s*\}/g,"");str[i]=str[i].replace(/\\end\s*\{\s*document\s*\}/g,"");str[i]=str[i].replace(/\\documentclass[^\}]*?\}/g,"");str[i]=str[i].replace(/\\usepackage[^\}]*?\}/g,"");str[i]=str[i].replace(/\\noindent/g,"");str[i]=str[i].replace(/\\notag/g,"");str[i]=str[i].replace(/\\ref\s*\{\s*(\w+)\}/g," \\[ref\\]$1\\[ ");str[i]=str[i].replace(/\\url\s*\{\s*([^\}\n]+)\}/g," \\[url\\]$1\\[ ");str[i]=str[i].replace(/\\href\s*\{\s*([^\}]+)\}\s*\{\s*([^\}]+)\}/g," \\[href\\]$1\\]$2\\[ ");str[i]=str[i].replace(/\\cite\s*\{\s*(\w+)\}/g," \\[cite\\]$1\\[ ");str[i]=str[i].replace(/\\qed/g,"\u220E");str[i]=str[i].replace(/\\endproof/g,"\u220E");str[i]=str[i].replace(/\\proof/g,"\\textbf{Proof: }");str[i]=str[i].replace(/\\n(?=\s)/g," \\[br\\] \\[ ");str[i]=str[i].replace(/\\newline/g," \\[br\\] \\[ ");str[i]=str[i].replace(/\\linebreak/g," \\[br\\] \\[ ");str[i]=str[i].replace(/\\smallskip/g," \\[logicalbreak\\]smallskip\\[ ");str[i]=str[i].replace(/\\medskip/g," \\[logicalbreak\\]medskip\\[ ");str[i]=str[i].replace(/\\bigskip/g," \\[logicalbreak\\]bigskip\\[ ");str[i]=str[i].replace(/[\n\r]+[ \f\n\r\t\v\u2028\u2029]*[\n\r]+/g," \\[logicalbreak\\]LaTeXMathML\\[ ");if(isIE){str[i]=str[i].replace(/\r/g," ");}
  str[i]=str[i].replace(/\\bibitem\s*([^\{]*\{\s*\w*\s*\})/g," \\[bibitem\\]$1\\[ ");str[i]=str[i].replace(/\\bibitem\s*/g," \\[bibitem\\] \\[ ");str[i]=str[i].replace(/\\item\s*\[\s*(\w+)\s*\]/g," \\[alistitem\\]$1\\[ ");str[i]=str[i].replace(/\\item\s*/g," \\[alistitem\\] \\[ ");str[i]=str[i].replace(/\\appendix/g," \\[appendix\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*figure\s*\}([\s\S]+?)\\end\s*\{\s*figure\s*\}/g," \\[figure\\]$1\\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*table\s*\}([\s\S]+?)\\end\s*\{\s*table\s*\}/g," \\[table\\]$1\\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*theorem\s*\}/g," \\[theorem\\]Theorem \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*theorem\s*\}/g," \\[endtheorem\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*definition\s*\}/g," \\[definition\\]Definition \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*definition\s*\}/g," \\[enddefinition\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*lemma\s*\}/g," \\[lemma\\]Lemma \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*lemma\s*\}/g," \\[endlemma\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*corollary\s*\}/g," \\[corollary\\]Corollary \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*corollary\s*\}/g," \\[endcorollary\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*proposition\s*\}/g," \\[proposition\\]Proposition \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*proposition\s*\}/g," \\[endproposition\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*example\s*\}/g," \\[example\\]Example \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*example\s*\}/g," \\[endexample\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*exercise\s*\}/g," \\[exercise\\]Exercise \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*exercise\s*\}/g," \\[endexercise\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*thebibliography\s*\}\s*\{\s*\w+\s*\}/g," \\[thebibliography\\]References \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*thebibliography\s*\}/g," \\[thebibliography\\]References \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*thebibliography\s*\}/g," \\[endthebibliography\\]References \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*proof\s*\}/g," \\[proof\\]Proof: \\[ ");if(isIE){str[i]=str[i].replace(/\\end\s*\{\s*proof\s*\}/g,"\u220E \\[endproof\\] \\[ ");}else{str[i]=str[i].replace(/\\end\s*\{\s*proof\s*\}/g," \\[endproof\\] \\[ ");}
  str[i]=str[i].replace(/\\title\s*\{\s*([^\}]+)\}/g," \\[title\\] \\[$1 \\[endtitle\\] \\[ ");str[i]=str[i].replace(/\\author\s*\{\s*([^\}]+)\}/g," \\[author\\] \\[$1 \\[endauthor\\] \\[ ");str[i]=str[i].replace(/\\address\s*\{\s*([^\}]+)\}/g," \\[address\\] \\[$1 \\[endaddress\\] \\[ ");str[i]=str[i].replace(/\\date\s*\{\s*([^\}]+)\}/g," \\[date\\] \\[$1 \\[enddate\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*keyword\s*\}/g," \\[keyword\\] \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*keyword\s*\}/g," \\[endkeyword\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*abstract\s*\}/g," \\[abstract\\] \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*abstract\s*\}/g," \\[endabstract\\] \\[ ");str[i]=str[i].replace(/\\begin\s*\{\s*(?!array|tabular)(\w+)\s*\}/g," \\[$1\\] \\[ ");str[i]=str[i].replace(/\\end\s*\{\s*(?!array|tabular)(\w+)\s*\}/g," \\[end$1\\] \\[ ");var sectionIndex=str[i].search(/\\section\s*\{\s*[\s\S]+\}/);while(sectionIndex>=0){str[i]=str[i].replace(/\\section\s*\{/," \\[section\\]");var delimcnt=1;for(var ii=sectionIndex;ii<str[i].length;ii++){if(str[i].charAt(ii)=="{"){delimcnt++};if(str[i].charAt(ii)=="}"){delimcnt--};if(delimcnt==0){str[i]=str[i].substring(0,ii)+"\\[ "+str[i].substring(ii+1,str[i].length);break;}};sectionIndex=str[i].search(/\\section\s*\{\s*[\s\S]+\}/);}
  sectionIndex=str[i].search(/\\subsection\s*\{\s*[\s\S]+\}/);while(sectionIndex>=0){str[i]=str[i].replace(/\\subsection\s*\{/," \\[subsection\\]");var delimcnt=1;for(var ii=sectionIndex;ii<str[i].length;ii++){if(str[i].charAt(ii)=="{"){delimcnt++};if(str[i].charAt(ii)=="}"){delimcnt--};if(delimcnt==0){str[i]=str[i].substring(0,ii)+"\\[ "+str[i].substring(ii+1,str[i].length);break;}};sectionIndex=str[i].search(/\\subsection\s*\{\s*[\s\S]+\}/);}
  sectionIndex=str[i].search(/\\subsubsection\s*\{\s*[\s\S]+\}/);while(sectionIndex>=0){str[i]=str[i].replace(/\\subsubsection\s*\{/," \\[subsubsection\\]");var delimcnt=1;for(var ii=sectionIndex;ii<str[i].length;ii++){if(str[i].charAt(ii)=="{"){delimcnt++};if(str[i].charAt(ii)=="}"){delimcnt--};if(delimcnt==0){str[i]=str[i].substring(0,ii)+"\\[ "+str[i].substring(ii+1,str[i].length);break;}};sectionIndex=str[i].search(/\\subsubsection\s*\{\s*[\s\S]+\}/);}
  var CatToNextEven="";var strtmp=str[i].split("\\[");for(var j=0;j<strtmp.length;j++){if(j%2){var strtmparray=strtmp[j].split("\\]");switch(strtmparray[0]){case"section":var nodeTmp=document.createElement("H2");nodeTmp.className='section';sectionCntr++;for(var div in LaTeXCounter){LaTeXCounter[div]=0};var nodeAnchor=document.createElement("a");if(inAppendix){nodeAnchor.className='appendixsection';}else{nodeAnchor.className='section';}
  var nodeNumString=makeNumberString("");var anchorSpan=document.createElement("span");anchorSpan.className="section";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(nodeNumString));nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className='section';nodeSpan.appendChild(document.createTextNode(nodeNumString+" "));nodeTmp.appendChild(nodeSpan);nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"subsection":var nodeTmp=document.createElement("H3");nodeTmp.className='subsection';LaTeXCounter["subsection"]++;LaTeXCounter["subsubsection"]=0;var nodeAnchor=document.createElement("a");nodeAnchor.className='subsection';var nodeNumString=makeNumberString(LaTeXCounter["subsection"]);var anchorSpan=document.createElement("span");anchorSpan.className="subsection";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(nodeNumString));nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className='subsection';nodeSpan.appendChild(document.createTextNode(nodeNumString+". "));nodeTmp.appendChild(nodeSpan);nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"subsubsection":var nodeTmp=document.createElement("H4");nodeTmp.className='subsubsection';LaTeXCounter["subsubsection"]++;var nodeAnchor=document.createElement("a");nodeAnchor.className='subsubsection';var nodeNumString=makeNumberString(LaTeXCounter["subsection"]+"."+LaTeXCounter["subsubsection"]);var anchorSpan=document.createElement("span");anchorSpan.className="subsubsection";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(nodeNumString));nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className='subsubsection';nodeSpan.appendChild(document.createTextNode(nodeNumString+". "));nodeTmp.appendChild(nodeSpan);nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"href":var nodeTmp=document.createElement("a");nodeTmp.className='LaTeXMathML';nodeTmp.href=strtmparray[1];nodeTmp.appendChild(document.createTextNode(strtmparray[2]));newFrag.appendChild(nodeTmp);break;case"url":var nodeTmp=document.createElement("a");nodeTmp.className='LaTeXMathML';nodeTmp.href=strtmparray[1];nodeTmp.appendChild(document.createTextNode(strtmparray[1]));newFrag.appendChild(nodeTmp);break;case"figure":var nodeTmp=document.createElement("table");nodeTmp.className='figure';var FIGtbody=document.createElement("tbody");var FIGlbl=strtmparray[1].match(/\\label\s*\{\s*(\w+)\s*\}/);strtmparray[1]=strtmparray[1].replace(/\\label\s*\{\w+\}/g,"");var capIndex=strtmparray[1].search(/\\caption\s*\{[\s\S]+\}/);var FIGcap="";if(capIndex>=0){var tmp=strtmparray[1];var delimcnt=0;var capstart=-1;for(var pos=capIndex;pos<tmp.length;pos++){if(tmp.charAt(pos)=="{"){delimcnt++};if(tmp.charAt(pos)=="}"){delimcnt--};if(delimcnt==1&&capstart<0){capstart=pos+1};if(delimcnt==0&&capstart>0){capend=pos-1;FIGcap=tmp.substring(capstart,pos);break}}}
  var FIGtr2=document.createElement("tr");var FIGtd2=document.createElement("td");FIGtd2.className="caption";var FIGanchor=document.createElement("a");FIGanchor.className="figure";if(FIGlbl!=null){FIGanchor.id=FIGlbl[1];}
  LaTeXCounter["figure"]++;var fignmbr=makeNumberString(LaTeXCounter["figure"]);var anchorSpan=document.createElement("span");anchorSpan.className="figure";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(fignmbr));FIGanchor.appendChild(anchorSpan);FIGtd2.appendChild(FIGanchor);var FIGspan=document.createElement("span");FIGspan.className="figure";FIGspan.appendChild(document.createTextNode("Figure "+fignmbr+". "));FIGtd2.appendChild(FIGspan);FIGtd2.appendChild(document.createTextNode(""+FIGcap));FIGtr2.appendChild(FIGtd2);FIGtbody.appendChild(FIGtr2);var IsSpecial=false;var FIGinfo=strtmparray[1].match(/\\includegraphics\s*\{([^\}]+)\}/);if(FIGinfo==null){FIGinfo=strtmparray[1].match(/\\includegraphics\s*\[[^\]]*\]\s*\{\s*([^\}]+)\s*\}/);}
  if(FIGinfo==null){FIGinfo=strtmparray[1].match(/\\special\s*\{\s*([^\}]+)\}/);IsSpecial=true};if(FIGinfo!=null){var FIGtr1=document.createElement("tr");var FIGtd1=document.createElement("td");FIGtd1.className="image";var FIGimg=document.createElement("img");var FIGsrc=FIGinfo[1];FIGimg.src=FIGsrc;FIGimg.alt="Figure "+FIGsrc+" did not load";FIGimg.title="Figure "+fignmbr+". "+FIGcap;FIGimg.id="figure"+fignmbr;FIGtd1.appendChild(FIGimg);FIGtr1.appendChild(FIGtd1);FIGtbody.appendChild(FIGtr1);}
  nodeTmp.appendChild(FIGtbody);newFrag.appendChild(nodeTmp);break;case"table":var nodeTmp=document.createElement("table");if(strtmparray[1].search(/\\centering/)>=0){nodeTmp.className='LaTeXtable centered';nodeTmp.align="center";}else{nodeTmp.className='LaTeXtable';};tableid++;nodeTmp.id="LaTeXtable"+tableid;var TABlbl=strtmparray[1].match(/\\label\s*\{\s*(\w+)\s*\}/);strtmparray[1]=strtmparray[1].replace(/\\label\s*\{\w+\}/g,"");var capIndex=strtmparray[1].search(/\\caption\s*\{[\s\S]+\}/);var TABcap="";if(capIndex>=0){var tmp=strtmparray[1];var delimcnt=0;var capstart=-1;for(var pos=capIndex;pos<tmp.length;pos++){if(tmp.charAt(pos)=="{"){delimcnt++};if(tmp.charAt(pos)=="}"){delimcnt--};if(delimcnt==1&&capstart<0){capstart=pos+1};if(delimcnt==0&&capstart>0){capend=pos-1;TABcap=tmp.substring(capstart,pos);break}}}
  if(TABcap!=""){var TABtbody=document.createElement("tbody");var TABcaption=document.createElement("caption");TABcaption.className="LaTeXtable centered";var TABanchor=document.createElement("a");TABanchor.className="LaTeXtable";if(TABlbl!=null){TABanchor.id=TABlbl[1];}
  LaTeXCounter["table"]++;var tabnmbr=makeNumberString(LaTeXCounter["table"]);var anchorSpan=document.createElement("span");anchorSpan.className="LaTeXtable";anchorSpan.style.display="none";anchorSpan.appendChild(document.createTextNode(tabnmbr));TABanchor.appendChild(anchorSpan);TABcaption.appendChild(TABanchor);var TABspan=document.createElement("span");TABspan.className="LaTeXtable";TABspan.appendChild(document.createTextNode("Table "+tabnmbr+". "));TABcaption.appendChild(TABspan);TABcaption.appendChild(document.createTextNode(""+TABcap));nodeTmp.appendChild(TABcaption);}
  var TABinfo=strtmparray[1].match(/\\begin\s*\{\s*tabular\s*\}([\s\S]+)\\end\s*\{\s*tabular\s*\}/);if(TABinfo!=null){var TABtbody=document.createElement('tbody');var TABrow=null;var TABcell=null;var row=0;var col=0;var TABalign=TABinfo[1].match(/^\s*\{([^\}]+)\}/);TABinfo=TABinfo[1].replace(/^\s*\{[^\}]+\}/,"");TABinfo=TABinfo.replace(/\\hline/g,"");TABalign[1]=TABalign[1].replace(/\|/g,"");TABalign[1]=TABalign[1].replace(/\s/g,"");TABinfo=TABinfo.split("\\\\");for(row=0;row<TABinfo.length;row++){TABrow=document.createElement("tr");TABinfo[row]=TABinfo[row].split("&");for(col=0;col<TABinfo[row].length;col++){TABcell=document.createElement("td");switch(TABalign[1].charAt(col)){case"l":TABcell.align="left";break;case"c":TABcell.align="center";break;case"r":TABcell.align="right";break;default:TABcell.align="left";};TABcell.appendChild(document.createTextNode(TABinfo[row][col]));TABrow.appendChild(TABcell);}
  TABtbody.appendChild(TABrow);}
  nodeTmp.appendChild(TABtbody);}
  newFrag.appendChild(nodeTmp);break;case"logicalbreak":var nodeTmp=document.createElement("p");nodeTmp.className=strtmparray[1];nodeTmp.appendChild(document.createTextNode("\u00A0"));newFrag.appendChild(nodeTmp);break;case"appendix":inAppendix=true;sectionCntr=0;break;case"alistitem":var EndDiv=document.createElement("div");EndDiv.className="endlistitem";newFrag.appendChild(EndDiv);var BegDiv=document.createElement("div");BegDiv.className="listitem";if(strtmparray[1]!=" "){var BegSpan=document.createElement("span");BegSpan.className="listitemmarker";var boldBegSpan=document.createElement("b");boldBegSpan.appendChild(document.createTextNode(strtmparray[1]+" "));BegSpan.appendChild(boldBegSpan);BegDiv.appendChild(BegSpan);}
  newFrag.appendChild(BegDiv);break;case"br":newFrag.appendChild(document.createElement("br"));break;case"bibitem":newFrag.appendChild(document.createElement("br"));var nodeTmp=document.createElement("a");nodeTmp.className='bibitem';var nodeSpan=document.createElement("span");nodeSpan.className='bibitem';bibcntr++;var lbl=strtmparray[1].match(/\{\s*(\w+)\s*\}/);strtmparray[1]=strtmparray[1].replace(/\s*\{\s*\w+\s*\}/g,"");strtmparray[1]=strtmparray[1].replace(/^\s*\[/,"");strtmparray[1]=strtmparray[1].replace(/\s*\]$/,"");strtmparray[1]=strtmparray[1].replace(/^\s+|\s+$/g,"");if(lbl==null){biblist[bibcntr]="bibitem"+bibcntr}else{biblist[bibcntr]=lbl[1];};nodeTmp.name=biblist[bibcntr];nodeTmp.id=biblist[bibcntr];if(strtmparray[1]!=""){nodeSpan.appendChild(document.createTextNode(strtmparray[1]));}else{nodeSpan.appendChild(document.createTextNode("["+bibcntr+"]"));}
  nodeTmp.appendChild(nodeSpan);newFrag.appendChild(nodeTmp);break;case"cite":var nodeTmp=document.createElement("a");nodeTmp.className='cite';nodeTmp.name='cite';nodeTmp.href="#"+strtmparray[1];newFrag.appendChild(nodeTmp);break;case"ref":var nodeTmp=document.createElement("a");nodeTmp.className='ref';nodeTmp.name='ref';nodeTmp.href="#"+strtmparray[1];newFrag.appendChild(nodeTmp);break;default:var nodeTmp=document.createElement("div");nodeTmp.className=strtmparray[0];if(IsCounter.test(strtmparray[0])){LaTeXCounter[strtmparray[0]]++;var nodeAnchor=document.createElement("a");nodeAnchor.className=strtmparray[0];var divnum=makeNumberString(LaTeXCounter[strtmparray[0]]);var anchorSpan=document.createElement("span");anchorSpan.className=strtmparray[0];anchorSpan.appendChild(document.createTextNode(divnum));anchorSpan.style.display="none";nodeAnchor.appendChild(anchorSpan);nodeTmp.appendChild(nodeAnchor);var nodeSpan=document.createElement("span");nodeSpan.className=strtmparray[0];nodeSpan.appendChild(document.createTextNode(strtmparray[1]+" "+divnum+". "));nodeTmp.appendChild(nodeSpan);}
  if(isIE){if(strtmparray[0]==("thebibliography"||"abstract"||"keyword"||"proof")){var nodeSpan=document.createElement("span");nodeSpan.className=strtmparray[0];nodeSpan.appendChild(document.createTextNode(strtmparray[1]));nodeTmp.appendChild(nodeSpan);}}
  if(strtmparray[0]=="endenumerate"||strtmparray[0]=="enditemize"||strtmparray[0]=="enddescription"){var endDiv=document.createElement("div");endDiv.className="endlistitem";newFrag.appendChild(endDiv);}
  newFrag.appendChild(nodeTmp);if(strtmparray[0]=="enumerate"||strtmparray[0]=="itemize"||strtmparray[0]=="description"){var endDiv=document.createElement("div");endDiv.className="listitem";newFrag.appendChild(endDiv);}}}else{strtmp[j]=strtmp[j].replace(/\\\$/g,"<per>");strtmp[j]=strtmp[j].replace(/\$([^\$]+)\$/g," \\[$1\\[ ");strtmp[j]=strtmp[j].replace(/<per>/g,"\\$");strtmp[j]=strtmp[j].replace(/\\begin\s*\{\s*math\s*\}([\s\S]+?)\\end\s*\{\s*math\s*\}/g," \\[$1\\[ ");var strtmptmp=strtmp[j].split("\\[");for(var jjj=0;jjj<strtmptmp.length;jjj++){if(jjj%2){var nodeTmp=document.createElement("span");nodeTmp.className='inlinemath';nodeTmp.appendChild(document.createTextNode("$"+strtmptmp[jjj]+"$"));newFrag.appendChild(nodeTmp);}else{var TagIndex=strtmptmp[jjj].search(/\\\w+/);var tmpIndex=TagIndex;while(tmpIndex>-1){if(/^\\textcolor/.test(strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length))){strtmptmp[jjj]=strtmptmp[jjj].replace(/\\textcolor\s*\{\s*(\w+)\s*\}\s*/," \\[textcolor\\]$1\\]|");}else{if(/^\\colorbox/.test(strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length))){strtmptmp[jjj]=strtmptmp[jjj].replace(/\\colorbox\s*\{\s*(\w+)\s*\}\s*/," \\[colorbox\\]$1\\]|");}else{strtmptmp[jjj]=strtmptmp[jjj].substring(0,TagIndex)+strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length).replace(/\\\s*(\w+)\s*/," \\[$1\\]|");}}
  TagIndex+=strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length).search(/\|/);TagIndex++;strtmptmp[jjj]=strtmptmp[jjj].replace(/\\\]\|/,"\\] ");if(strtmptmp[jjj].charAt(TagIndex)=="{"){strtmptmp[jjj]=strtmptmp[jjj].substring(0,TagIndex)+strtmptmp[jjj].substring(TagIndex+1,strtmptmp[jjj].length);var delimcnt=1;for(var kk=TagIndex;kk<strtmptmp[jjj].length;kk++){if(strtmptmp[jjj].charAt(kk)=="{"){delimcnt++};if(strtmptmp[jjj].charAt(kk)=="}"){delimcnt--};if(delimcnt==0){break;}}
  strtmptmp[jjj]=strtmptmp[jjj].substring(0,kk)+"\\[ "+strtmptmp[jjj].substring(kk+1,strtmptmp[jjj].length);TagIndex=kk+3;}else{strtmptmp[jjj]=strtmptmp[jjj].substring(0,TagIndex)+"\\[ "+strtmptmp[jjj].substring(TagIndex+1,strtmptmp[jjj].length);TagIndex=TagIndex+3;}
  if(TagIndex<strtmptmp[jjj].length){tmpIndex=strtmptmp[jjj].substring(TagIndex,strtmptmp[jjj].length).search(/\\\w+/);}
  else{tmpIndex=-1};TagIndex+=tmpIndex;}
  strtmptmp[jjj]=strtmptmp[jjj].replace(/\\\\\s*\\\\/g,"\\\\");strtmptmp[jjj]=strtmptmp[jjj].replace(/\\\\/g," \\[br\\] \\[ ");strtmptmp[jjj]=strtmptmp[jjj].replace(/\\label\s*\{\s*(\w+)\s*\}/g," \\[a\\]$1\\[ ");var strlbls=strtmptmp[jjj].split("\\[");for(var jj=0;jj<strlbls.length;jj++){if(jj%2){var strtmparray=strlbls[jj].split("\\]");switch(strtmparray[0]){case"textcolor":var nodeTmp=document.createElement("span");nodeTmp.className='LaTeXColor';if(IsColorName.test(strtmparray[1].toLowerCase())){nodeTmp.style.color=LaTeXColor[strtmparray[1].toLowerCase()];}else{nodeTmp.style.color=strtmparray[1];};nodeTmp.appendChild(document.createTextNode(strtmparray[2]));newFrag.appendChild(nodeTmp);break;case"colorbox":var nodeTmp=document.createElement("span");nodeTmp.className='LaTeXColor';if(IsColorName.test(strtmparray[1].toLowerCase())){nodeTmp.style.background=LaTeXColor[strtmparray[1].toLowerCase()];}else{nodeTmp.style.background=strtmparray[1];};nodeTmp.appendChild(document.createTextNode(strtmparray[2]));newFrag.appendChild(nodeTmp);break;case"br":newFrag.appendChild(document.createElement("br"));break;case"a":var nodeTmp=document.createElement("a");nodeTmp.className='LaTeXMathMLlabel';nodeTmp.id=strtmparray[1];nodeTmp.style.display="none";newFrag.appendChild(nodeTmp);break;default:var nodeTmp=document.createElement("span");nodeTmp.className=strtmparray[0];nodeTmp.appendChild(document.createTextNode(strtmparray[1]))
  newFrag.appendChild(nodeTmp);}}else{newFrag.appendChild(document.createTextNode(strlbls[jj]));}}}}}}}};TheBody.parentNode.replaceChild(newFrag,TheBody);}}}
  return TheBody;}
  function LaTeXDivsAndRefs(thebody){var TheBody=thebody;var EndDivClass=null;var AllDivs=TheBody.getElementsByTagName("div");var lbl2id="";var lblnode=null;for(var i=AllDivs.length-1;i>=0;i--){EndDivClass=AllDivs[i].className.match(/end\w+/);if(EndDivClass!=null){EndDivClass=EndDivClass[0];var DivClass=EndDivClass.substring(3,EndDivClass.length);var EndDivNode=AllDivs[i];break;}}
  while(EndDivClass!=null){var newFrag=document.createDocumentFragment();var RootNode=EndDivNode.parentNode;var ClassCount=1;while(EndDivNode.previousSibling!=null&&ClassCount>0){switch(EndDivNode.previousSibling.className){case EndDivClass:ClassCount++;newFrag.insertBefore(EndDivNode.previousSibling,newFrag.firstChild);break;case DivClass:if(EndDivNode.previousSibling.nodeName=="DIV"){ClassCount--;if(lbl2id!=""){EndDivNode.previousSibling.id=lbl2id;lbl2id=""}
  if(ClassCount==0){RootNode=EndDivNode.previousSibling;}else{newFrag.insertBefore(EndDivNode.previousSibling,newFrag.firstChild);}};break;case'LaTeXMathMLlabel':lbl2id=EndDivNode.previousSibling.id;EndDivNode.parentNode.removeChild(EndDivNode.previousSibling);break;default:newFrag.insertBefore(EndDivNode.previousSibling,newFrag.firstChild);}}
  RootNode.appendChild(newFrag);EndDivNode.parentNode.removeChild(EndDivNode);AllDivs=TheBody.getElementsByTagName("DIV");for(i=AllDivs.length-1;i>=0;i--){EndDivClass=AllDivs[i].className.match(/end\w+/);if(EndDivClass!=null){ClassCount=0;EndDivClass=EndDivClass[0];DivClass=EndDivClass.substring(3,EndDivClass.length);EndDivNode=AllDivs[i];RootNode=EndDivNode.parentNode;break;}}}
  var AllDivs=TheBody.getElementsByTagName("div");var DIV2LI=null;for(var i=0;i<AllDivs.length;i++){if(AllDivs[i].className=="itemize"||AllDivs[i].className=="enumerate"||AllDivs[i].className=="description"){if(AllDivs[i].className=="itemize"){RootNode=document.createElement("UL");}else{RootNode=document.createElement("OL");}
  RootNode.className='LaTeXMathML';if(AllDivs[i].hasChildNodes()){AllDivs[i].removeChild(AllDivs[i].firstChild)};while(AllDivs[i].hasChildNodes()){if(AllDivs[i].firstChild.hasChildNodes()){DIV2LI=document.createElement("LI");while(AllDivs[i].firstChild.hasChildNodes()){DIV2LI.appendChild(AllDivs[i].firstChild.firstChild);}
  if(DIV2LI.firstChild.className=="listitemmarker"){DIV2LI.style.listStyleType="none";}
  RootNode.appendChild(DIV2LI)}
  AllDivs[i].removeChild(AllDivs[i].firstChild);}
  AllDivs[i].appendChild(RootNode);}}
  var AllAnchors=TheBody.getElementsByTagName("a");for(var i=0;i<AllAnchors.length;i++){if(AllAnchors[i].className=="ref"||AllAnchors[i].className=="cite"){var label=AllAnchors[i].href.match(/\#(\w+)/);if(label!=null){var labelNode=document.getElementById(label[1]);if(labelNode!=null){var TheSpans=labelNode.getElementsByTagName("SPAN");if(TheSpans!=null){var refNode=TheSpans[0].cloneNode(true);refNode.style.display="inline"
  refNode.className=AllAnchors[i].className;AllAnchors[i].appendChild(refNode);}}}}}
  return TheBody;}
  var AMbody;var AMnoMathML=false,AMtranslated=false;function translate(spanclassAM){if(!AMtranslated){AMtranslated=true;AMinitSymbols();var LaTeXContainers=[];var AllContainers=document.getElementsByTagName('*');var ExtendName="";for(var k=0,l=0;k<AllContainers.length;k++){ExtendName=" "+AllContainers[k].className+" ";if(ExtendName.match(/\sLaTeX\s/)!=null){LaTeXContainers[l]=AllContainers[k];l++;}};if(LaTeXContainers.length>0){for(var m=0;m<LaTeXContainers.length;m++){AMbody=LaTeXContainers[m];try{AMbody=LaTeXDivsAndRefs(LaTeXpreProcess(AMbody));}catch(err){alert("Unknown Error: Defaulting to Original LaTeXMathML");}
  if(AMbody.tagName=="PRE"){var PreChilds=document.createDocumentFragment();var DivChilds=document.createElement("DIV");while(AMbody.hasChildNodes()){DivChilds.appendChild(AMbody.firstChild);}
  PreChilds.appendChild(DivChilds);AMbody.parentNode.replaceChild(PreChilds,AMbody);AMbody=DivChilds;}
  AMprocessNode(AMbody,false,spanclassAM);}}else{AMbody=document.getElementsByTagName("body")[0];try{AMbody=LaTeXDivsAndRefs(LaTeXpreProcess(AMbody));}catch(err){alert("Unknown Error: Defaulting to Original LaTeXMathML");}
  AMprocessNode(AMbody,false,spanclassAM);}}}
  if(isIE){document.write("<object id=\"mathplayer\" classid=\"clsid:32F66A20-7614-11D4-BD11-00104BD3F987\"></object>");document.write("<?import namespace=\"m\" implementation=\"#mathplayer\"?>");}
  function generic()
  {translate();};if(typeof window.addEventListener!='undefined')
  {window.addEventListener('load',generic,false);}
  else if(typeof document.addEventListener!='undefined')
  {document.addEventListener('load',generic,false);}
  else if(typeof window.attachEvent!='undefined')
  {window.attachEvent('onload',generic);}
  else
  {if(typeof window.onload=='function')
  {var existing=onload;window.onload=function()
  {existing();generic();};}
  else
  {window.onload=generic;}}
  /*]]>*/
  </script>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#-haskell--ghc"> Haskell  GHC</a><ul>
<li><a href="#-"> </a></li>
<li><a href="#-stg"> STG</a></li>
<li><a href="#-stg"> STG</a><ul>
<li><a href="#"></a></li>
<li><a href="#"></a></li>
<li><a href="#-----">     </a></li>
<li><a href="#----">   -</a></li>
<li><a href="#----">   -</a></li>
</ul></li>
<li><a href="#---.---">   .   </a></li>
<li><a href="#-.--"> .  </a></li>
<li><a href="#--">  </a><ul>
<li><a href="#-"> </a></li>
<li><a href="#-"> </a></li>
<li><a href="#---">   </a></li>
</ul></li>
<li><a href="#-"> </a><ul>
<li><a href="#-"> </a></li>
<li><a href="#-inline"> INLINE</a></li>
<li><a href="#-rules"> RULES</a></li>
<li><a href="#-unpack"> UNPACK</a></li>
</ul></li>
<li><a href="#-"> </a></li>
<li><a href="#"></a></li>
</ul></li>
</ul>
</div>
<div id="header">  
<div id="nav">
<a id="prev" class="button" href="9.html"><strong><code><font color="#b2590f">&lt;-</font></code></strong></a><a id="next" class="button" href="11.html"><strong><code><font color="#b2590f">-&gt;</font></code></strong></a>
<div id="home">
<a href="toc.html"><code><font color="#b2590f">::</font></code>  <code><font color="#b2590f">::</font></code></a>
</div></div>  
 </div> 

<h1 id="-haskell--ghc"><a href="#-haskell--ghc"> Haskell  GHC</a></h1>
<p>       Haskell  GHC.     .   Hugs (     Haskell   ,       GHC).         Hskell   GHC. GHC      ,       Haskell. GHC   .   .     (Simon Peyton Jones)    (Simon Marlow).</p>
<p>GHC    .   ,    (  Prelude)     (    , ,   ).  GHC      Haskell.     C.        (      )     .          .       ,   GHC.      .</p>
<p>       ( )  .      Haskell,       ?       ,      .       ,     .      .       .            .       .       (stack),  (heap)   (registers).</p>
<p>        ,  .      .     :   ,    .       . ,     ,     ,   .               .     ,     ,   .       ,        ,     ,                       .         .    .         .</p>
<p>     .    (       )   (     ,      ,       ).     :   ,        ,     ,      .    .       ,          .</p>
<p>  GHC           .     .     ,   .      ,  ,      ,    .</p>
<h2 id="-"><a href="#-"> </a></h2>
<p>   .</p>
<div class="figure">
<img src="../pic/10/ghc.png" alt=" " /><p class="caption"> </p>
</div>
<p>      .      .      ,      ,     .         .      ,    .        ,     - ,      .     .           .  ,    ,     GHC. Haskell     .      ,        17. ,        ,     Haskell  Core.</p>
<p>Core     ,      Haskell.   ,   Haskell    (  ).    ,     .              Core.      Core.         <code><font color=Green>Core</font> <font color="#b2590f">-&gt;</font> <font color=Green>Core</font></code>.            (  inlining), ,     <code><font color="#b2590f">case</font></code>-  ,      .   GHC     (strictness analysis).    ,  GHC   ,               .  -   .         .      .</p>
<p>  Core   STG.   ,  Core.    ,        .   STG    <code><font color=Green>C</font><font color="#2149c1">--</font></code>.    ,  .      ,      .       .   C, LLVM    (,    ).</p>
<h2 id="-stg"><a href="#-stg"> STG</a></h2>
<p>STG   Spineless Tagless G-machine. G-machine  -        ( Graph).       . Spineless  Tagless      G-,     GHC. Tagless        (  ,           ),  Spineless   ,     -,        , STG    .     STG.     .          .</p>
<div class="figure">
<img src="../pic/10/stg1.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<p>  STG  ,    Haskell   .       STG. ,      .    <code><font color="#b2590f">if</font></code>-   <code><font color="#b2590f">case</font></code>-.  <code><font color="#b2590f">where</font></code>-.     ,           .  STG <code><font color="#b2590f">let</font></code>-     (<code><font color="#b2590f">let</font></code>)   (<code><font color=Black>letrec</font></code>).     ,    ,      .</p>
<p>    ? ,        (  ,  ).         .    Haskell  :</p>
<pre><font color=Black>foldr</font> f <font color=Black>(</font>g x y<font color=Black>)</font> <font color=Black>(</font>h x<font color=Black>)</font></pre>
<p> STG    :</p>
<pre><font color="#b2590f">let</font> gxy <font color="#b2590f">=</font> <font color=Green>THUNK</font> <font color=Black>(</font>g x y<font color=Black>)</font>
    hx  <font color="#b2590f">=</font> <font color=Green>THUNK</font> <font color=Black>(</font>h x<font color=Black>)</font>
<font color="#b2590f">in</font>  foldr f gxy hx</pre>
<p>   .  ?     ,      .        .   Haskell     ,       ,    <span class="LaTeX">$\bullet$</span>.</p>
<p>      STG:</p>
<ul>
<li><p>     <em></em>  <code><font color="#b2590f">let</font></code>-</p></li>
<li><p>    <em></em>  <code><font color="#b2590f">case</font></code>-</p></li>
</ul>
<p> <code><font color="#b2590f">let</font> a <font color="#b2590f">=</font> obj <font color="#b2590f">in</font> e</code>      <code><font color=Black>obj</font></code>   <code><font color=Black>a</font></code>    <code><font color=Black>e</font></code>.  <code><font color="#b2590f">case</font> e <font color="#b2590f">of</font></code>~<code><font color=Black>{</font>alt1<font color=Black>;</font><font color=Black>...</font><font color=Black>;</font>alt2<font color=Black>}</font></code>      <code><font color=Black>e</font></code>      .    ,           .   <code><font color="#b2590f">case</font></code>-        .</p>
<p>    STG      .</p>
<pre><font color="#b2590f">data</font> <font color=Green>Nat</font> <font color="#b2590f">=</font> <font color=Green>Zero</font> <font color="#b2590f">|</font> <font color=Green>Succ</font> <font color=Green>Nat</font>

<font color=Black>zero</font>    <font color="#b2590f">=</font> <font color=Green>Zero</font>
<font color=Black>one</font>     <font color="#b2590f">=</font> <font color=Green>Succ</font> zero
<font color=Black>two</font>     <font color="#b2590f">=</font> <font color=Green>Succ</font> one

<font color=Black>foldNat</font> <font color="#b2590f">::</font> a <font color="#b2590f">-&gt;</font> <font color=Black>(</font>a <font color="#b2590f">-&gt;</font> a<font color=Black>)</font> <font color="#b2590f">-&gt;</font> <font color=Green>Nat</font> <font color="#b2590f">-&gt;</font> a
<font color=Black>foldNat</font> z  s  <font color=Green>Zero</font>      <font color="#b2590f">=</font> z
<font color=Black>foldNat</font> z  s  <font color=Black>(</font><font color=Green>Succ</font> n<font color=Black>)</font>  <font color="#b2590f">=</font> s <font color=Black>(</font>foldNat z s n<font color=Black>)</font>

<font color=Black>add</font> a <font color="#b2590f">=</font> foldNat a   <font color=Green>Succ</font>
<font color=Black>mul</font> a <font color="#b2590f">=</font> foldNat one <font color=Black>(</font>add a<font color=Black>)</font> 

<font color=Black>exp</font> <font color="#b2590f">=</font> <font color=Black>(</font><font color="#b2590f">\</font>x <font color="#b2590f">-&gt;</font> add <font color=Black>(</font>add x x<font color=Black>)</font> x<font color=Black>)</font> <font color=Black>(</font>add <font color=Green>Zero</font> two<font color=Black>)</font></pre>
<p>  STG:</p>
<pre><font color="#b2590f">data</font> <font color=Green>Nat</font> <font color="#b2590f">=</font> <font color=Green>Zero</font> <font color="#b2590f">|</font> <font color=Green>Succ</font> <font color=Green>Nat</font>

<font color=Black>zero</font>    <font color="#b2590f">=</font> <font color=Green>CON</font><font color=Black>(</font><font color=Green>Zero</font><font color=Black>)</font>
<font color=Black>one</font>     <font color="#b2590f">=</font> <font color=Green>CON</font><font color=Black>(</font><font color=Green>Succ</font> zero<font color=Black>)</font>
<font color=Black>two</font>     <font color="#b2590f">=</font> <font color=Green>CON</font><font color=Black>(</font><font color=Green>Succ</font> one<font color=Black>)</font>

<font color=Black>foldNat</font> <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> z s arg <font color="#b2590f">-&gt;</font> 
            <font color="#b2590f">case</font> arg <font color="#b2590f">of</font> 
                <font color=Green>Zero</font>    <font color="#b2590f">-&gt;</font> z
                <font color=Green>Succ</font> n  <font color="#b2590f">-&gt;</font> <font color="#b2590f">let</font> next <font color="#b2590f">=</font> <font color=Green>THUNK</font> <font color=Black>(</font>foldNat z s n<font color=Black>)</font>
                           <font color="#b2590f">in</font>  s next  
          <font color=Black>)</font>

<font color=Black>add</font>     <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> a <font color="#b2590f">-&gt;</font>
            <font color="#b2590f">let</font> succ <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> x <font color="#b2590f">-&gt;</font> 
                        <font color="#b2590f">let</font> r <font color="#b2590f">=</font> <font color=Green>CON</font><font color=Black>(</font><font color=Green>Succ</font> x<font color=Black>)</font> 
                        <font color="#b2590f">in</font> r<font color=Black>)</font>
            <font color="#b2590f">in</font>  foldNat a succ
          <font color=Black>)</font>

<font color=Black>mul</font>     <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> a <font color="#b2590f">-&gt;</font> 
            <font color="#b2590f">let</font> succ <font color="#b2590f">=</font> <font color=Green>THUNK</font> <font color=Black>(</font>add a<font color=Black>)</font>
            <font color="#b2590f">in</font>  foldNat one succ
          <font color=Black>)</font>

<font color=Black>exp</font>     <font color="#b2590f">=</font> <font color=Green>THUNK</font><font color=Black>(</font> 
            <font color="#b2590f">let</font> f <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> x <font color="#b2590f">-&gt;</font> <font color="#b2590f">let</font> axx <font color="#b2590f">=</font> <font color=Green>THUNK</font> <font color=Black>(</font>add x x<font color=Black>)</font>
                              <font color="#b2590f">in</font>  add axx x<font color=Black>)</font> 
                a <font color="#b2590f">=</font> <font color=Green>THUNK</font> <font color=Black>(</font>add <font color=Green>Zero</font> two<font color=Black>)</font>
            <font color="#b2590f">in</font>  f a    
          <font color=Black>)</font></pre>
<p>     <code><font color=Black></font> <font color="#b2590f">=</font> </code>.    ,     ,      <code><font color="#b2590f">let</font></code>-.    <code><font color=Green>THUNK</font></code>     (constant applicative form   CAF).</p>
<h2 id="-stg"><a href="#-stg"> STG</a></h2>
<p>      .     ?      .         .    </p>
<pre><font color=Black>f</font> x y</pre>
<p> <code><font color=Black>f</font></code>      ,   .      :</p>
<ul>
<li><p><em>-</em> (push-enter).     ,   <em></em>    ,   <em></em>   .       <code><font color=Black>f</font></code>    ,   ,         ,     ,     ,         .        .</p></li>
<li><p><em>-</em> (eval-apply).        ,    .      (  ),          .   ,    ,   <em></em>     ,    ,        <em></em>    .</p></li>
</ul>
<p>   , ,    <code><font color=Black>f</font></code>  .   -     <code><font color=Black>x</font></code>  <code><font color=Black>y</font></code>,        .  -   <code><font color=Black>(</font>f x<font color=Black>)</font></code>,  <code><font color=Black>y</font></code>  ,      <code><font color=Black>y</font></code>.    ?   ,    <code><font color=Black>f</font> x</code>   ,        ,     <code><font color=Green>PAP</font></code>,    .</p>
<p>     ,     .  ,       ,    .      GHC   .    GHC       .   ,          ,    ,            .     .        .        Simon Marlow, Simon Peyton Jones: Making a Fast Curry: Push/Enter vs.Eval/Apply.    GHC,          .</p>
<h3 id=""><a href="#"></a></h3>
<p>    <em></em> (closure).   ,            ,    :</p>
<pre><font color=Black>mul</font>     <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> a <font color="#b2590f">-&gt;</font> 
            <font color="#b2590f">let</font> succ <font color="#b2590f">=</font> <font color=Green>THUNK</font> <font color=Black>(</font>add a<font color=Black>)</font>
            <font color="#b2590f">in</font>  foldNat one succ
          <font color=Black>)</font></pre>
<p> ,   <code><font color=Green>THUNK</font><font color=Black>(</font>add a<font color=Black>)</font></code>     <code><font color=Black>a</font></code>,      .    .        <em></em> (free).         <code><font color=Black>(</font>add a<font color=Black>)</font></code>,       ,     .    <em></em> (payload).         .         ,   ,     .            .</p>
<p>   :</p>
<ul>
<li><code><font color=Green>FUN</font></code>   ;</li>
<li><code><font color=Green>PAP</font></code>   ;</li>
<li><code><font color=Green>CON</font></code>    ;</li>
<li><code><font color=Green>THUNK</font></code>   ;</li>
<li><code><font color=Green>BLACKHOLE</font></code>        <code><font color=Green>THUNK</font></code>.      .</li>
</ul>
<p>  ,     ,         .</p>
<h3 id=""><a href="#"></a></h3>
<p>     .       <code><font color="#b2590f">case</font></code>-  <code><font color=Green>THUNK</font></code>-.   <code><font color="#b2590f">case</font></code>-         ,      <code><font color="#b2590f">case</font></code>-.   <code><font color=Green>THUNK</font></code>-    ,       .</p>
<p>    -       .      -        .     ?           ,       ,   ,       .           .       . ,     :</p>
<div class="figure">
<img src="../pic/10/stg2.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<h3 id="-----"><a href="#-----">     </a></h3>
<p>     .     <span class="LaTeX">$e$</span>,  <span class="LaTeX">$s$</span>   <span class="LaTeX">$H$</span>.            .    :</p>
<p><span class="LaTeX">$e_1;\quad s_1;\quad H_1\quad \Rightarrow\quad e_2;\quad s_2;\quad H_2$</span></p>
<p>    ,  ,      .   ,          .      ,          .            : <span class="LaTeX">$elem\ :\ s$</span>.</p>
<p>   <code><font color="#b2590f">let</font></code>-:</p>
<div class="figure">
<img src="../pic/10/stg-rules-let.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<p>         <span class="LaTeX">$obj$</span>   (  ) <span class="LaTeX">$x&#39;$</span>.  <span class="LaTeX">$e[x&#39;/x]$</span>   <span class="LaTeX">$x$</span>  <span class="LaTeX">$x&#39;$</span>   <span class="LaTeX">$e$</span>.</p>
<p>     <code><font color="#b2590f">case</font></code>-.</p>
<div class="figure">
<img src="../pic/10/stg-rules-case.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<p>    ,     <code><font color="#b2590f">case</font></code>-   <span class="LaTeX">$e$</span>.                 <span class="LaTeX">$e$</span>.       ,           <code><font color="#b2590f">case</font></code>-.         .       ,     ,        .</p>
<p>    <code><font color=Green>THUNK</font></code>-.</p>
<div class="figure">
<img src="../pic/10/stg-rules-thunk.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<p>      <span class="LaTeX">$e$</span>,              <span class="LaTeX">$e$</span>.         <span class="LaTeX">$x$</span>  <span class="LaTeX">$BLACKHOLE$</span>.     ,     ,      <span class="LaTeX">$BLACKHOLE$</span>.     <span class="LaTeX">$THUNK$</span>       .       .     ,      <span class="LaTeX">$x$</span>   .</p>
<p>  ,         :</p>
<div class="figure">
<img src="../pic/10/stg-rules-apply.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<p>       .        .</p>
<h3 id="----"><a href="#----">   -</a></h3>
<div class="figure">
<img src="../pic/10/stg-rules-push-enter.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<p>    .     ,        .       <code><font color=Black>f</font></code>,      <span class="LaTeX">$n$</span>.      <span class="LaTeX">$n$</span>         <span class="LaTeX">$e$</span>.       ,          .         .           <span class="LaTeX">$g$</span>   <span class="LaTeX">$PAP$</span>.</p>
<h3 id="----"><a href="#----">   -</a></h3>
<div class="figure">
<img src="../pic/10/stg-rules-eval-apply.png" alt=" STG" /><p class="caption"> STG</p>
</div>
<p>    .      <span class="LaTeX">$f$</span> ,   <span class="LaTeX">$f$</span>  ,        <span class="LaTeX">$FUN$</span>,    .         <span class="LaTeX">$FUN$</span>,        <span class="LaTeX">$FUN$</span>.        ,     .    ,     <span class="LaTeX">$PAP$</span>.     ,   ,   <span class="LaTeX">$f$</span>   .   <span class="LaTeX">$THUNK$</span>.         .       .         (      ).     .    <span class="LaTeX">$THUNK$</span>    <span class="LaTeX">$FUN$</span>  <span class="LaTeX">$PAP$</span>.     .</p>
<p>   -      .    -      ,    -            .    -     .        .       .</p>
<h2 id="---.---"><a href="#---.---">   .   </a></h2>
<p>  ,       ,       .         .         .   ,            ,    .   ,       .     .      ( )    <code><font color=Green>CON</font></code>.</p>
<p>           .        ,    .     .   ,     .       .</p>
<p>                  (  ).   :</p>
<pre><font color="#b2590f">data</font> <font color=Green>Int</font> <font color="#b2590f">=</font> <font color=Green>I</font><font color=Black><em>#</em></font> <font color=Green>Int</font><font color=Black><em>#</em></font>              <font color="#2149c1">-- 2 </font>
<font color="#b2590f">data</font> <font color=Green>Pair</font> a b <font color="#b2590f">=</font> <font color=Green>Pair</font> a b        <font color="#2149c1">-- 3 </font></pre>
<p>    .     ,        ,         .  ,          .            <code><font color=Green>True</font></code>  <code><font color=Green>False</font></code>.</p>
<p>     <code><font color="#b2590f">[</font><font color=Green>Pair</font> <font color="#0000ee">1</font> <font color="#0000ee">2</font><font color="#b2590f">]</font></code>.        STG</p>
<pre><font color=Black>nil</font> <font color="#b2590f">=</font> <font color=Green>[]</font>                 <font color="#2149c1">--   (  )</font>

<font color="#b2590f">let</font> x1  <font color="#b2590f">=</font> <font color=Green>I</font><font color=Black><em>#</em></font> <font color="#0000ee">1</font>           <font color="#2149c1">-- 2 </font>
    x2  <font color="#b2590f">=</font> <font color=Green>I</font><font color=Black><em>#</em></font> <font color="#0000ee">2</font>           <font color="#2149c1">-- 2 </font>
    p   <font color="#b2590f">=</font> <font color=Green>Pair</font> x1 x2     <font color="#2149c1">-- 3 </font>
    val <font color="#b2590f">=</font> <font color=Green>Cons</font> p nil     <font color="#2149c1">-- 3 </font>
<font color="#b2590f">in</font>  val                  <font color="#2149c1">------------</font>
                         <font color="#2149c1">-- 10    </font></pre>
<p>   <code><font color=Green>CON</font></code>    ,       .    ,    ,    10 .     ,   <code><font color="#b2590f">[</font><font color=Green>Just</font> <font color=Green>True</font><font color=Black>,</font> <font color=Green>Just</font> <font color=Green>True</font><font color=Black>,</font> <font color=Green>Nothing</font><font color="#b2590f">]</font></code>:</p>
<pre><font color=Black>nil</font>     <font color="#b2590f">=</font> <font color=Green>[]</font>
<font color=Black>true</font>    <font color="#b2590f">=</font> <font color=Green>True</font>
<font color=Black>nothing</font> <font color="#b2590f">=</font> <font color=Green>Nothing</font>

<font color="#b2590f">let</font> x1 <font color="#b2590f">=</font> <font color=Green>Just</font> true          <font color="#2149c1">-- 2 </font>
    x2 <font color="#b2590f">=</font> <font color=Green>Just</font> true          <font color="#2149c1">-- 2 </font>
    p1 <font color="#b2590f">=</font> <font color=Green>Cons</font> nothing nil   <font color="#2149c1">-- 3 </font>
    p2 <font color="#b2590f">=</font> <font color=Green>Cons</font> x2 p1         <font color="#2149c1">-- 3 </font>
    p3 <font color="#b2590f">=</font> <font color=Green>Cons</font> x1 p2         <font color="#2149c1">-- 3  </font>
<font color="#b2590f">in</font>  p3                      <font color="#2149c1">----------</font>
                            <font color="#2149c1">-- 13 </font></pre>
<p>    16, 32  64 .     .  ,        ,    .        ,      .        .</p>
<h2 id="-.--"><a href="#-.--"> .  </a></h2>
<p>      ,      .      .          -  ,     ,          .      - ,    .   -   .      ,   <em> </em> (garbage collector),         (garbage collection  GC).</p>
<p>    GHC     ,      (Cheney).       .          .         ,       .      ,       .     ,            .       ,      .  ,      30    ,     10 ,    10 ,            40 .</p>
<p>    .   ,       .   ,  .     ,          .    .         ,    <em></em> (nursery area),          ,                    .              .     ,     (minor GC),        ,     (major GC).       .</p>
<h2 id="--"><a href="#--">  </a></h2>
<p>     .     GHC       .       .    <code><font color=Black>s</font></code>  .      .</p>
<h3 id="-"><a href="#-"> </a></h3>
<p>      .       <code><font color=Black>s</font><font color="#b2590f">[</font>file<font color="#b2590f">]</font></code>  <code><font color=Green>S</font><font color="#b2590f">[</font>file<font color="#b2590f">]</font></code>.        (realtime system  RTS,   ),     <code><font color=Black>+</font><font color=Green>RTS</font> <font color=Black>...</font> <font color="#2149c1">-</font><font color=Green>RTS</font></code>,        ,       <code><font color=Green>RTS</font></code>     <code><font color=Black>ghc</font> <font color="#2149c1">--make file.hs +RTS ...</font></code>    :</p>
<pre><font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color=Black>main</font> <font color="#b2590f">=</font> print <font color=Black>$</font> sum <font color="#b2590f">[</font><font color="#0000ee">1</font> <font color="#b2590f">..</font> <font color="#0000ee">1e5</font><font color="#b2590f">]</font></pre>
<p> :</p>
<pre>$ ghc --make sum.hs -rtsopts -fforce-recomp</pre>
<p> <code><font color=Black>rtsopts</font></code>         ,         .   <code><font color=Black>fforce</font><font color="#2149c1">-</font>recomp</code>      .       ( <code><font color=Black>s</font><font color="#b2590f">[</font>file<font color="#b2590f">]</font></code>,         <code><font color=Black>stderr</font></code>):</p>
<pre>$ ./sum +RTS -sstderr
5.00005e9
      14,145,284 bytes allocated in the heap
      11,110,432 bytes copied during GC
       2,865,704 bytes maximum residency (3 sample(s))
         460,248 bytes maximum slop
               7 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0        21 colls,     0 par    0.00s    0.01s     0.0006s    0.0036s
  Gen  1         3 colls,     0 par    0.01s    0.01s     0.0026s    0.0051s

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time    0.01s  (  0.01s elapsed)
  GC      time    0.01s  (  0.02s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time    0.02s  (  0.03s elapsed)

  %GC     time      60.0%  (69.5% elapsed)

  Alloc rate    1,767,939,507 bytes per MUT second

  Productivity  40.0% of total user, 26.0% of total elapsed</pre>
<p>       .   :</p>
<pre><font color=Black>bytes</font> allocated <font color="#b2590f">in</font> the heap  <font color="#2149c1">--     </font>
                             <font color="#2149c1">--     </font>
<font color=Black>bytes</font> copied during <font color=Green>GC</font>       <font color="#2149c1">--   </font>
                             <font color="#2149c1">--     </font>
<font color=Black>bytes</font> maximum residency      <font color="#2149c1">--       </font>
                             <font color="#2149c1">--      </font>
<font color=Black>bytes</font> maximum slop           <font color="#2149c1">--    - </font>

<font color=Black>total</font> memory <font color="#b2590f">in</font> use          <font color="#2149c1">--       </font></pre>
<p> <code><font color=Black>bytes</font> maximum residency</code>     ,        .          .   ,               .       .       ,   ()    .</p>
<p>       .  ,  GC  21   ( 0)  3  ( 1).    . <code><font color=Green>INIT</font></code>  <code><font color=Green>EXIT</font></code>      . <code><font color=Green>MUT</font></code>    , ,       (MUTation) . <code><font color=Green>GC</font></code>    .  GHC    ,    60%    .   .    .    ,     .        :</p>
<pre><font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color="#b2590f">import</font> <font color=Green>Data</font><font color=Black>.</font><font color=Green>List</font><font color=Black>(</font>foldl'<font color=Black>)</font>

<font color=Black>sum'</font> <font color="#b2590f">=</font> foldl' <font color=Black>(</font><font color=Black>+</font><font color=Black>)</font> <font color="#0000ee">0</font>

<font color=Black>main</font> <font color="#b2590f">=</font> print <font color=Black>$</font> sum' <font color="#b2590f">[</font><font color="#0000ee">1</font> <font color="#b2590f">..</font> <font color="#0000ee">1e5</font><font color="#b2590f">]</font></pre>
<p>:</p>
<pre>$ ghc --make sumStrict.hs -rtsopts -fforce-recomp</pre>
<p>  :</p>
<pre>$ ./sumStrict +RTS -sstderr
5.00005e9
      10,474,128 bytes allocated in the heap
          24,324 bytes copied during GC
          27,072 bytes maximum residency (1 sample(s))
          27,388 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0        19 colls,     0 par    0.00s    0.00s     0.0000s    0.0000s
  Gen  1         1 colls,     0 par    0.00s    0.00s     0.0001s    0.0001s

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time    0.01s  (  0.01s elapsed)
  GC      time    0.00s  (  0.00s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time    0.01s  (  0.01s elapsed)

  %GC     time       0.0%  (3.0% elapsed)

  Alloc rate    1,309,266,000 bytes per MUT second

  Productivity 100.0% of total user, 116.0% of total elapsed</pre>
<p> ,      .      .    ,     27  ,  2     .      GC.  GHC         .       GHC.      .  <code><font color=Green>H</font></code>       .  <code><font color=Green>A</font></code>     .      512  (   ).        .      ,    ,      .</p>
<p>   ,           .     32   512     (    ,    k  m):</p>
<pre>$ ./sumStrict +RTS -A32k -sstderr
...
                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0       318 colls,     0 par    0.00s    0.00s     0.0000s    0.0000s
  Gen  1         1 colls,     0 par    0.00s    0.00s     0.0001s    0.0001s
...
  MUT     time    0.01s  (  0.01s elapsed)
  GC      time    0.00s  (  0.00s elapsed)
...
  %GC     time       0.0%  (11.8% elapsed)</pre>
<p> ,        ,       .    <code><font color=Green>H</font><font color="#b2590f">[</font>size<font color="#b2590f">]</font></code>         .     .         ,  20 :</p>
<pre><font color=Black>./</font>sum <font color=Black>+</font><font color=Green>RTS</font> <font color="#2149c1">-</font><font color=Green>A1m</font> <font color="#2149c1">-</font><font color=Green>H20m</font> <font color="#2149c1">-</font>sstderr
<font color="#0000ee">5.00005e9</font>
      <font color="#0000ee">14</font><font color=Black>,</font><font color="#0000ee">145</font><font color=Black>,</font><font color="#0000ee">284</font> bytes allocated <font color="#b2590f">in</font> the heap
         <font color="#0000ee">319</font><font color=Black>,</font><font color="#0000ee">716</font> bytes copied during <font color=Green>GC</font>
         <font color="#0000ee">324</font><font color=Black>,</font><font color="#0000ee">136</font> bytes maximum residency <font color=Black>(</font><font color="#0000ee">1</font> sample<font color=Black>(</font>s<font color=Black>)</font><font color=Black>)</font>
          <font color="#0000ee">60</font><font color=Black>,</font><font color="#0000ee">888</font> bytes maximum slop
              <font color="#0000ee">22</font> <font color=Green>MB</font> total memory <font color="#b2590f">in</font> use <font color=Black>(</font><font color="#0000ee">1</font> <font color=Green>MB</font> lost due to fragmentation<font color=Black>)</font>

                                    <font color=Green>Tot</font> time <font color=Black>(</font>elapsed<font color=Black>)</font>  <font color=Green>Avg</font> pause  <font color=Green>Max</font> pause
  <font color=Green>Gen</font>  <font color="#0000ee">0</font>         <font color="#0000ee">2</font> colls<font color=Black>,</font>     <font color="#0000ee">0</font> par    <font color="#0000ee">0.00</font>s    <font color="#0000ee">0.00</font>s     <font color="#0000ee">0.0001</font>s    <font color="#0000ee">0.0001</font>s
  <font color=Green>Gen</font>  <font color="#0000ee">1</font>         <font color="#0000ee">1</font> colls<font color=Black>,</font>     <font color="#0000ee">0</font> par    <font color="#0000ee">0.00</font>s    <font color="#0000ee">0.00</font>s     <font color="#0000ee">0.0007</font>s    <font color="#0000ee">0.0007</font>s

  <font color=Green>INIT</font>    time    <font color="#0000ee">0.00</font>s  <font color=Black>(</font>  <font color="#0000ee">0.00</font>s elapsed<font color=Black>)</font>
  <font color=Green>MUT</font>     time    <font color="#0000ee">0.02</font>s  <font color=Black>(</font>  <font color="#0000ee">0.02</font>s elapsed<font color=Black>)</font>
  <font color=Green>GC</font>      time    <font color="#0000ee">0.00</font>s  <font color=Black>(</font>  <font color="#0000ee">0.00</font>s elapsed<font color=Black>)</font>
  <font color=Green>EXIT</font>    time    <font color="#0000ee">0.00</font>s  <font color=Black>(</font>  <font color="#0000ee">0.00</font>s elapsed<font color=Black>)</font>
  <font color=Green>Total</font>   time    <font color="#0000ee">0.02</font>s  <font color=Black>(</font>  <font color="#0000ee">0.02</font>s elapsed<font color=Black>)</font>

  <font color=Black>%</font><font color=Green>GC</font>     time       <font color="#0000ee">0.0</font><font color=Black>%</font>  <font color=Black>(</font><font color="#0000ee">4.4</font><font color=Black>%</font> elapsed<font color=Black>)</font>

  <font color=Green>Alloc</font> rate    <font color="#0000ee">884</font><font color=Black>,</font><font color="#0000ee">024</font><font color=Black>,</font><font color="#0000ee">998</font> bytes per <font color=Green>MUT</font> second

  <font color=Green>Productivity</font> <font color="#0000ee">100.0</font><font color=Black>%</font> <font color="#b2590f">of</font> total user<font color=Black>,</font> <font color="#0000ee">78.6</font><font color=Black>%</font> <font color="#b2590f">of</font> total elapsed</pre>
<p>     (,       )     .    <code><font color=Green>S</font></code>  <code><font color=Black>s</font></code>        .       .</p>
<pre><font color=Black>./</font>sum <font color=Black>+</font><font color=Green>RTS</font> <font color="#2149c1">-</font><font color=Green>Sfile</font></pre>
<p>  <code><font color=Black>file</font></code>    :</p>
<pre>                                  
<font color=Black></font>       <font color=Green>GC</font>             <font color=Green>Total</font>             <font color=Green></font> 

 <font color=Green>Alloc</font>    <font color=Green>Copied</font>     <font color=Green>Live</font>    <font color=Green>GC</font>    <font color=Green>GC</font>     <font color=Green>TOT</font>     <font color=Green>TOT</font>  <font color=Green>Page</font> <font color=Green>Flts</font>
 bytes     bytes     bytes  user  elap    user    elap
<font color="#0000ee">545028</font>    <font color="#0000ee">150088</font>    <font color="#0000ee">174632</font>  <font color="#0000ee">0.00</font>  <font color="#0000ee">0.00</font>    <font color="#0000ee">0.00</font>    <font color="#0000ee">0.00</font>    <font color="#0000ee">0</font>    <font color="#0000ee">0</font>  <font color=Black>(</font><font color=Green>Gen</font><font color="#b2590f">:</font>  <font color="#0000ee">1</font><font color=Black>)</font>
<font color="#0000ee">523264</font>    <font color="#0000ee">298956</font>    <font color="#0000ee">324136</font>  <font color="#0000ee">0.00</font>  <font color="#0000ee">0.00</font>    <font color="#0000ee">0.00</font>    <font color="#0000ee">0.00</font>    <font color="#0000ee">0</font>    <font color="#0000ee">0</font>  <font color=Black>(</font><font color=Green>Gen</font><font color="#b2590f">:</font>  <font color="#0000ee">0</font><font color=Black>)</font>
<font color=Black>...</font></pre>
<p>        .    .         :           .    ,  .        <code><font color=Green>A</font></code>  <code><font color=Green>H</font></code>.         ,      .     .  ,          <code><font color=Black>seq</font></code>   .         ,     .       ?     .      .       .     ,    GHC     .</p>
<p>   <code><font color=Black>performGC</font></code>   <code><font color=Green>System</font><font color=Black>.</font><font color=Green>Mem</font></code>,     .    -           .      ,  ,   ,   ,    .  <code><font color=Black>performGC</font></code>      .</p>
<h3 id="-"><a href="#-"> </a></h3>
<h4 id="----"><a href="#----">    </a></h4>
<p>   /   .    ,    ,   .   :</p>
<pre><font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color=Black>concatR</font> <font color="#b2590f">=</font> foldr <font color=Black>(</font><font color=Black>++</font><font color=Black>)</font> <font color=Green>[]</font> 
<font color=Black>concatL</font> <font color="#b2590f">=</font> foldl <font color=Black>(</font><font color=Black>++</font><font color=Black>)</font> <font color=Green>[]</font>

<font color=Black>fun</font> <font color="#b2590f">::</font> <font color=Green>Double</font>
<font color=Black>fun</font> <font color="#b2590f">=</font> test concatL <font color="#2149c1">-</font> test concatR
    <font color="#b2590f">where</font> test f <font color="#b2590f">=</font> last <font color=Black>$</font> f <font color=Black>$</font> map return <font color="#b2590f">[</font><font color="#0000ee">1</font> <font color="#b2590f">..</font> <font color="#0000ee">1e6</font><font color="#b2590f">]</font>

<font color=Black>main</font> <font color="#b2590f">=</font> print fun</pre>
<p>   ,  -    <code><font color=Black>concatX</font></code>   .    ,       <code><font color=Green>SCC</font></code>:</p>
<pre><font color=Black>concatR</font> <font color="#b2590f">=</font> <font color="#2149c1">{-# SCC "right" #-}</font> foldr <font color=Black>(</font><font color=Black>++</font><font color=Black>)</font> <font color=Green>[]</font> 
<font color=Black>concatL</font> <font color="#b2590f">=</font> <font color="#2149c1">{-# SCC "left"  #-}</font> foldl <font color=Black>(</font><font color=Black>++</font><font color=Black>)</font> <font color=Green>[]</font></pre>
<p>,        .    .  <code><font color=Green>SCC</font></code>       (cost center).      .    ,       .       ,     .        <code><font color=Black>prof</font></code>,       :</p>
<pre>$ ghc --make concat.hs -rtsopts -prof -fforce-recomp
$ ./concat +RTS -p</pre>
<p>         <code><font color=Black>p</font></code>.      <code><font color=Black>concat</font><font color=Black>.</font>prof</code>.   :</p>
<pre>	   concat <font color=Black>+</font><font color=Green>RTS</font> <font color="#2149c1">-</font>p <font color="#2149c1">-</font><font color=Green>RTS</font>

	total time  <font color="#b2590f">=</font>        <font color="#0000ee">1.45</font> secs   <font color=Black>(</font><font color="#0000ee">1454</font> ticks <font color="#b2590f">@</font> <font color="#0000ee">1000</font> us<font color=Black>,</font> <font color="#0000ee">1</font> processor<font color=Black>)</font>
	total alloc <font color="#b2590f">=</font> <font color="#0000ee">1</font><font color=Black>,</font><font color="#0000ee">403</font><font color=Black>,</font><font color="#0000ee">506</font><font color=Black>,</font><font color="#0000ee">324</font> bytes  <font color=Black>(</font>excludes profiling overheads<font color=Black>)</font>

<font color=Green>COST</font> <font color=Green>CENTRE</font> <font color=Green>MODULE</font>  <font color=Black>%</font>time <font color=Black>%</font>alloc

<font color=Black>left</font>        <font color=Green>Main</font>     <font color="#0000ee">99.8</font>   <font color="#0000ee">99.8</font>


                                                                 individual     inherited
<font color=Green>COST</font> <font color=Green>CENTRE</font> <font color=Green>MODULE</font>                             no<font color=Black>.</font>   entries  <font color=Black>%</font>time <font color=Black>%</font>alloc   <font color=Black>%</font>time <font color=Black>%</font>alloc

<font color=Green>MAIN</font>        <font color=Green>MAIN</font>                                <font color="#0000ee">46</font>         <font color="#0000ee">0</font>    <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>   <font color="#0000ee">100.0</font>  <font color="#0000ee">100.0</font>
 <font color=Green>CAF</font>        <font color=Green>GHC</font><font color=Black>.</font><font color=Green>Integer</font><font color=Black>.</font><font color=Green>Logarithms</font><font color=Black>.</font><font color=Green>Internals</font>    <font color="#0000ee">91</font>         <font color="#0000ee">0</font>    <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>     <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>
 <font color=Green>CAF</font>        <font color=Green>GHC</font><font color=Black>.</font><font color=Green>IO</font><font color=Black>.</font><font color=Green>Encoding</font><font color=Black>.</font><font color=Green>Iconv</font>               <font color="#0000ee">71</font>         <font color="#0000ee">0</font>    <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>     <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>
 <font color=Green>CAF</font>        <font color=Green>GHC</font><font color=Black>.</font><font color=Green>IO</font><font color=Black>.</font><font color=Green>Encoding</font>                     <font color="#0000ee">70</font>         <font color="#0000ee">0</font>    <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>     <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>
 <font color=Green>CAF</font>        <font color=Green>GHC</font><font color=Black>.</font><font color=Green>IO</font><font color=Black>.</font><font color=Green>Handle</font><font color=Black>.</font><font color=Green>FD</font>                    <font color="#0000ee">57</font>         <font color="#0000ee">0</font>    <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>     <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>
 <font color=Green>CAF</font>        <font color=Green>GHC</font><font color=Black>.</font><font color=Green>Conc</font><font color=Black>.</font><font color=Green>Signal</font>                     <font color="#0000ee">56</font>         <font color="#0000ee">0</font>    <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>     <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>
 <font color=Green>CAF</font>        <font color=Green>Main</font>                                <font color="#0000ee">53</font>         <font color="#0000ee">0</font>    <font color="#0000ee">0.2</font>    <font color="#0000ee">0.2</font>   <font color="#0000ee">100.0</font>  <font color="#0000ee">100.0</font>
  right     <font color=Green>Main</font>                                <font color="#0000ee">93</font>         <font color="#0000ee">1</font>    <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>     <font color="#0000ee">0.0</font>    <font color="#0000ee">0.0</font>
  left      <font color=Green>Main</font>                                <font color="#0000ee">92</font>         <font color="#0000ee">1</font>   <font color="#0000ee">99.8</font>   <font color="#0000ee">99.8</font>    <font color="#0000ee">99.8</font>   <font color="#0000ee">99.8</font></pre>
<p> ,          <code><font color=Black>concatL</font></code>.  <code><font color=Black>concatR</font></code>    (<code><font color=Black>time</font></code>)       (<code><font color=Black>alloc</font></code>).       . <code><font color=Black>individual</font></code>     ,  <code><font color=Black>inherited</font></code>         .  <code><font color=Black>entries</font></code>    .            .       <code><font color=Black>auto</font><font color="#2149c1">-</font>all</code>.  ,         ,    .      <code><font color=Green>CAF</font></code>.              <code><font color=Black>caf</font><font color="#2149c1">-</font>all</code>.    :</p>
<pre><font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color=Black>fun1</font> <font color="#b2590f">=</font> test concatL <font color="#2149c1">-</font> test concatR
<font color=Black>fun2</font> <font color="#b2590f">=</font> test concatL <font color=Black>+</font> test concatR

<font color=Black>test</font> f <font color="#b2590f">=</font> last <font color=Black>$</font> f <font color=Black>$</font> map return <font color="#b2590f">[</font><font color="#0000ee">1</font> <font color="#b2590f">..</font> <font color="#0000ee">1e4</font><font color="#b2590f">]</font>

<font color=Black>concatR</font> <font color="#b2590f">=</font> foldr <font color=Black>(</font><font color=Black>++</font><font color=Black>)</font> <font color=Green>[]</font> 
<font color=Black>concatL</font> <font color="#b2590f">=</font> foldl <font color=Black>(</font><font color=Black>++</font><font color=Black>)</font> <font color=Green>[]</font> 

<font color=Black>main</font> <font color="#b2590f">=</font> print fun1 <font color=Black>&gt;&gt;</font> print fun2</pre>
<p>:</p>
<pre>$ ghc --make concat2.hs -rtsopts -prof -auto-all -caf-all -fforce-recomp
$ ./concat2 +RTS -p
0.0
20000.0</pre>
<p>     <code><font color=Black>concat2</font><font color=Black>.</font>prof</code>       .        ,  ,       ,            <code><font color=Green>K</font></code>,     GHC    .</p>
<h4 id="---"><a href="#---">   </a></h4>
<p>            .           .             .      ,  GC     .         <code><font color=Black>prof</font></code>     ,         <code><font color=Black>hc</font></code>, <code><font color=Black>hm</font></code>, <code><font color=Black>hd</font></code>, <code><font color=Black>hy</font></code>  <code><font color=Black>hr</font></code>.      <code><font color=Black>h</font></code>,   <code><font color=Black>heap</font></code> ().     ,    .      <code><font color=Black></font><font color=Black>.</font>hp</code>,         <code><font color=Green>PostScript</font></code>    <code><font color=Black>hp2ps</font></code>,      GHC.</p>
<p>    (    ):</p>
<pre><font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color="#b2590f">import</font> <font color=Green>System</font><font color=Black>.</font><font color=Green>Environment</font><font color=Black>(</font>getArgs<font color=Black>)</font>

<font color=Black>main</font> <font color="#b2590f">=</font> print <font color=Black>.</font> sum2 <font color=Black>.</font> xs <font color=Black>.</font> read <font color=Black>=&lt;&lt;</font> fmap head getArgs  
    <font color="#b2590f">where</font> xs n <font color="#b2590f">=</font> <font color="#b2590f">[</font><font color="#0000ee">1</font> <font color="#b2590f">..</font> <font color="#0000ee">10</font> <font color=Black>^</font> n<font color="#b2590f">]</font>

<font color=Black>sum2</font> <font color="#b2590f">::</font> <font color="#b2590f">[</font><font color=Green>Int</font><font color="#b2590f">]</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Green>Int</font><font color=Black>,</font> <font color=Green>Int</font><font color=Black>)</font>
<font color=Black>sum2</font> <font color="#b2590f">=</font> iter <font color=Black>(</font><font color="#0000ee">0</font><font color=Black>,</font> <font color="#0000ee">0</font><font color=Black>)</font>
    <font color="#b2590f">where</font> iter c  <font color=Green>[]</font>     <font color="#b2590f">=</font> c
          iter c  <font color=Black>(</font>x<font color="#b2590f">:</font>xs<font color=Black>)</font> <font color="#b2590f">=</font> iter <font color=Black>(</font>tick x c<font color=Black>)</font> xs

<font color=Black>tick</font> <font color="#b2590f">::</font> <font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Green>Int</font><font color=Black>,</font> <font color=Green>Int</font><font color=Black>)</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Green>Int</font><font color=Black>,</font> <font color=Green>Int</font><font color=Black>)</font>
<font color=Black>tick</font> x <font color=Black>(</font>c0<font color=Black>,</font> c1<font color=Black>)</font> <font color="#b2590f">|</font> even x    <font color="#b2590f">=</font> <font color=Black>(</font>c0<font color=Black>,</font> c1 <font color=Black>+</font> <font color="#0000ee">1</font><font color=Black>)</font>
                <font color="#b2590f">|</font> otherwise <font color="#b2590f">=</font> <font color=Black>(</font>c0 <font color=Black>+</font> <font color="#0000ee">1</font><font color=Black>,</font> c1<font color=Black>)</font></pre>
<p>   :</p>
<pre>$ ghc --make leak.hs -rtsopts -prof -auto-all</pre>
<p>  ,       8       40% .</p>
<pre>$ ./leak 6 +RTS -K30m -sstderr
...
                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0       493 colls,     0 par    0.26s    0.26s     0.0005s    0.0389s
  Gen  1         8 colls,     0 par    0.14s    0.20s     0.0248s    0.0836s
...
    Productivity  40.5% of total user, 35.6% of total elapsed
</pre>
<p>    .</p>
<pre>$ ./leak 6 +RTS -K30m -hc
(500000,500000)
$ hp2ps -e80mm -c leak.hp</pre>
<p>      <code><font color=Black>hc</font></code>  ,      <code><font color=Black>.</font>hp</code>.       ,       .        <code><font color=Black>iN</font></code>,  <code><font color=Green>N</font></code>    .       .  <code><font color=Black>c</font></code>,   ,      ,   <code><font color=Black>e80mm</font></code>,   ,        LaTeX.  <code><font color=Black>e</font></code>    .    .</p>
<div class="figure">
<img src="../pic/10/leak.png" alt="    " /><p class="caption">    </p>
</div>
<p>           <code><font color=Green>L</font></code>.    .</p>
<pre>$ ./leak 6 +RTS -K30m -hc -L45
(500000,500000)
$ hp2ps -e80mm -c leak.hp</pre>
<div class="figure">
<img src="../pic/10/leak_1.png" alt="    " /><p class="caption">    </p>
</div>
<p>   <code><font color=Black>hd</font></code>   ,    :</p>
<pre>$ ./leak 6 +RTS -K30m -hd -L45
(500000,500000)
$ hp2ps -e80mm -c leak.hp</pre>
<p>      (). <code><font color=Green>BLACKHOLE</font></code>   ,   <code><font color=Green>THUNK</font></code>    . <code><font color=Green>I</font><font color=Black><em>#</em></font></code>     <code><font color=Green>Int</font></code>. <code><font color=Black>sat_sUa</font></code>  <code><font color=Black>sat_sUd</font></code>      .                   <code><font color=Black>p</font></code>    <code><font color=Black>leak</font><font color=Black>.</font>prof</code>          .                    .</p>
<div class="figure">
<img src="../pic/10/leak_2.png" alt="    " /><p class="caption">    </p>
</div>
<p> ,   ?    ,     ,       ,    ,     ,    ,   .   ,       ,         .  :</p>
<pre><font color="#2149c1">{-# Language BangPatterns #-}</font>
<font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color="#b2590f">import</font> <font color=Green>System</font><font color=Black>.</font><font color=Green>Environment</font><font color=Black>(</font>getArgs<font color=Black>)</font>

<font color=Black>main</font> <font color="#b2590f">=</font> print <font color=Black>.</font> sum2 <font color=Black>.</font> xs <font color=Black>.</font> read <font color=Black>=&lt;&lt;</font> fmap head getArgs  
    <font color="#b2590f">where</font> xs n <font color="#b2590f">=</font> <font color="#b2590f">[</font><font color="#0000ee">1</font> <font color="#b2590f">..</font> <font color="#0000ee">10</font> <font color=Black>^</font> n<font color="#b2590f">]</font>

<font color=Black>sum2</font> <font color="#b2590f">::</font> <font color="#b2590f">[</font><font color=Green>Int</font><font color="#b2590f">]</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Green>Int</font><font color=Black>,</font> <font color=Green>Int</font><font color=Black>)</font>
<font color=Black>sum2</font> <font color="#b2590f">=</font> iter <font color=Black>(</font><font color="#0000ee">0</font><font color=Black>,</font> <font color="#0000ee">0</font><font color=Black>)</font>
    <font color="#b2590f">where</font> iter c  <font color=Green>[]</font>     <font color="#b2590f">=</font> c
          iter c  <font color=Black>(</font>x<font color="#b2590f">:</font>xs<font color=Black>)</font> <font color="#b2590f">=</font> iter <font color=Black>(</font>tick x c<font color=Black>)</font> xs

<font color=Black>tick</font> <font color="#b2590f">::</font> <font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Green>Int</font><font color=Black>,</font> <font color=Green>Int</font><font color=Black>)</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Green>Int</font><font color=Black>,</font> <font color=Green>Int</font><font color=Black>)</font>
<font color=Black>tick</font> x <font color=Black>(</font><font color=Black>!</font>c0<font color=Black>,</font> <font color=Black>!</font>c1<font color=Black>)</font> <font color="#b2590f">|</font> even x    <font color="#b2590f">=</font> <font color=Black>(</font>c0<font color=Black>,</font> c1 <font color=Black>+</font> <font color="#0000ee">1</font><font color=Black>)</font>
                  <font color="#b2590f">|</font> otherwise <font color="#b2590f">=</font> <font color=Black>(</font>c0 <font color=Black>+</font> <font color="#0000ee">1</font><font color=Black>,</font> c1<font color=Black>)</font></pre>
<p>   <code><font color=Black>tick</font></code> .    :</p>
<pre>$ ghc --make leak2.hs -rtsopts -prof -auto-all
$ ./leak2 6 +RTS -K30m -hc
(500000,500000)
$ hp2ps -e80mm -c leak2.hp</pre>
<p> .   .      . <code><font color=Black>tick</font></code>  ,    ,      <code><font color=Black>iter</font></code>   <code><font color=Black>tick</font></code>.  <code><font color=Black>iter</font></code>    :</p>
<div class="figure">
<img src="../pic/10/leak2.png" alt=" " /><p class="caption"> </p>
</div>
<pre><font color=Black>sum2</font> <font color="#b2590f">::</font> <font color="#b2590f">[</font><font color=Green>Int</font><font color="#b2590f">]</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Green>Int</font><font color=Black>,</font> <font color=Green>Int</font><font color=Black>)</font>
<font color=Black>sum2</font> <font color="#b2590f">=</font> iter <font color=Black>(</font><font color="#0000ee">0</font><font color=Black>,</font> <font color="#0000ee">0</font><font color=Black>)</font>
    <font color="#b2590f">where</font> iter <font color=Black>!</font>c  <font color=Green>[]</font>     <font color="#b2590f">=</font> c
          iter <font color=Black>!</font>c  <font color=Black>(</font>x<font color="#b2590f">:</font>xs<font color=Black>)</font> <font color="#b2590f">=</font> iter <font color=Black>(</font>tick x c<font color=Black>)</font> xs</pre>
<p>    :</p>
<pre>$ ghc --make leak2.hs -rtsopts -prof -auto-all
$ ./leak2 6 +RTS -K30m -hc
(500000,500000)
$ hp2ps -e80mm -c leak2.hp</pre>
<p> ,       .       ,   .  .   <code><font color=Black>hX</font></code>        .          (<code><font color=Black>hm</font></code>),       (<code><font color=Black>hd</font></code>),     (<code><font color=Black>hy</font></code>).</p>
<div class="figure">
<img src="../pic/10/leak3.png" alt="    " /><p class="caption">    </p>
</div>
<h3 id="---"><a href="#---">   </a></h3>
<p><code><font color="#b2590f">case</font></code>-           .    ,     -      :</p>
<pre><font color=Black>***</font> <font color=Green>Exception</font><font color="#b2590f">:</font> <font color=Green>Prelude</font><font color=Black>.</font>head<font color="#b2590f">:</font> empty list</pre>
<p></p>
<pre><font color=Black>***</font> <font color=Green>Exception</font><font color="#b2590f">:</font> <font color=Green>Maybe</font><font color=Black>.</font>fromJust<font color="#b2590f">:</font> <font color=Green>Nothing</font></pre>
<p>      .      .          .       GHC    <code><font color=Black>xc</font></code>.</p>
<p>    :</p>
<pre><font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color=Black>addEvens</font> <font color="#b2590f">::</font> <font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Green>Int</font>
<font color=Black>addEvens</font> a b 
    <font color="#b2590f">|</font> even a <font color=Black>&amp;&amp;</font> even b <font color="#b2590f">=</font> a <font color=Black>+</font> b

<font color=Black>q</font> <font color="#b2590f">=</font> zipWith addEvens <font color="#b2590f">[</font><font color="#0000ee">0</font><font color=Black>,</font> <font color="#0000ee">2</font><font color=Black>,</font> <font color="#0000ee">4</font><font color=Black>,</font> <font color="#0000ee">6</font><font color=Black>,</font> <font color="#0000ee">7</font><font color=Black>,</font> <font color="#0000ee">8</font><font color=Black>,</font> <font color="#0000ee">10</font><font color="#b2590f">]</font> <font color=Black>(</font>repeat <font color="#0000ee">0</font><font color=Black>)</font>

<font color=Black>main</font> <font color="#b2590f">=</font> print q</pre>
<p> ,    <code><font color=Black>xc</font></code>      :</p>
<pre>$ ghc --make break.hs -rtsopts -prof
$ ./break +RTS -xc
*** Exception (reporting due to +RTS -xc): (THUNK_2_0), stack trace: 
  Main.CAF
break: break.hs:(4,1)-(5,30): Non-exhaustive patterns in function addEvens</pre>
<p>         ,   <code><font color=Black>(</font><font color="#0000ee">4</font><font color=Black>,</font><font color="#0000ee">1</font><font color=Black>)</font><font color="#2149c1">-</font><font color=Black>(</font><font color="#0000ee">5</font><font color=Black>,</font><font color="#0000ee">30</font><font color=Black>)</font></code>.     <code><font color=Black>addEvens</font></code>.    .      .      ,       .   ,       <code><font color=Green>CAF</font></code>  .   :</p>
<pre>$ ghc --make break.hs -rtsopts -prof -caf-all -auto-all
$ ./break +RTS -xc
*** Exception (reporting due to +RTS -xc): (THUNK_2_0), stack trace: 
  Main.addEvens,
  called from Main.q,
  called from Main.CAF:q
  --> evaluated by: Main.main,
  called from :Main.CAF:main
break: break.hs:(4,1)-(5,30): Non-exhaustive patterns in function addEvens</pre>
<p>      ,       <code><font color=Black>q</font></code>,     <code><font color=Black>main</font></code>.</p>
<h2 id="-"><a href="#-"> </a></h2>
<p>        ,     <code><font color=Green>Core</font> <font color="#b2590f">-&gt;</font> <font color=Green>Core</font></code>.      .</p>
<h3 id="-"><a href="#-"> </a></h3>
<p>       .        <code><font color=Green>O</font></code>. ,    ,    .         .      :</p>
<ul>
<li> <code><font color="#2149c1">-</font><font color=Green>O</font></code>   ,     .</li>
<li><code><font color="#2149c1">-</font><font color=Green>O0</font></code>    </li>
<li><code><font color="#2149c1">-</font><font color=Green>O</font></code>   .</li>
<li><code><font color=Green>O2</font></code>   ,   ,   <code><font color=Green>O2</font></code>     <code><font color=Green>O</font></code>  .</li>
</ul>
<p>       ,         <code><font color=Green>O</font></code>:</p>
<pre><font color=Black>ghc</font> <font color="#2149c1">--make sum.hs -O </font></pre>
<p>   .</p>
<p>         GHC.     GHC   .    GHC       .    <code><font color="#2149c1">-</font>fexcess<font color="#2149c1">-</font>precision</code>,     ,      <code><font color=Green>Double</font></code>.        ,   .</p>
<h3 id="-inline"><a href="#-inline"> INLINE</a></h3>
<p>        <code><font color=Green>Prelude</font></code>,        :</p>
<pre><font color="#2149c1">-- | Function composition.</font>
<font color="#2149c1">{-# INLINE (.) #-}</font>
<font color="#2149c1">-- Make sure it has TWO args only on the left, so that it inlines</font>
<font color="#2149c1">-- when applied to two functions, even if there is no final argument</font>
<font color=Black>(</font><font color=Black>.</font><font color=Black>)</font>    <font color="#b2590f">::</font> <font color=Black>(</font>b <font color="#b2590f">-&gt;</font> c<font color=Black>)</font> <font color="#b2590f">-&gt;</font> <font color=Black>(</font>a <font color="#b2590f">-&gt;</font> b<font color=Black>)</font> <font color="#b2590f">-&gt;</font> a <font color="#b2590f">-&gt;</font> c
<font color=Black>(</font><font color=Black>.</font><font color=Black>)</font> f g <font color="#b2590f">=</font> <font color="#b2590f">\</font>x <font color="#b2590f">-&gt;</font> f <font color=Black>(</font>g x<font color=Black>)</font></pre>
<p>          <code><font color=Green>INLINE</font></code>.     ,             .     .         ,    (     )       .   GHC     :</p>
<pre><font color=Black>(</font><font color=Black>.</font><font color=Black>)</font> f g <font color="#b2590f">=</font> <font color="#b2590f">\</font>x <font color="#b2590f">-&gt;</font> f <font color=Black>(</font>g x<font color=Black>)</font>

<font color=Black>(</font><font color=Black>.</font><font color=Black>)</font> f g x <font color="#b2590f">=</font> f <font color=Black>(</font>g x<font color=Black>)</font></pre>
<p>         ,       . GHC         ,    .   GHC     .      <code><font color=Green>O</font></code>,     .   GHC     (  <code><font color=Black>.</font>hi</code>)    ,       .            .  <code><font color=Green>INLINE</font></code>   GHC  .        <code><font color=Green>INELINABLE</font></code>.            .</p>
<p>          <code><font color="#2149c1">-</font>funfolding<font color="#2149c1">-</font>use<font color="#2149c1">-</font>threshold<font color="#b2590f">=</font><font color="#0000ee">16</font></code>. ,           ,  GHC     ,         ,    ,    .</p>
<p> <code><font color=Green>INLINE</font></code>     ,       .        :</p>
<pre><font color="#b2590f">instance</font> <font color=Green>Monad</font> <font color=Green>T</font> <font color="#b2590f">where</font>
    <font color="#2149c1">{-# INLINE return #-}</font>
    return <font color="#b2590f">=</font> <font color=Black>...</font>
    <font color="#2149c1">{-# INLINE (&gt;&gt;=) #-}</font>
    <font color=Black>(</font><font color=Black>&gt;&gt;=</font><font color=Black>)</font>  <font color="#b2590f">=</font> <font color=Black>...</font></pre>
<p>     .         <code><font color=Green>INLINE</font></code>,  GHC   .        ,    <code><font color=Black>.</font>hi</code>.</p>
<p>        <code><font color=Black>ddump</font><font color="#2149c1">-</font>hi</code>:</p>
<pre><font color="#b2590f">module</font> <font color=Green>Inline</font><font color=Black>(</font>f<font color=Black>,</font> g<font color=Black>)</font> <font color="#b2590f">where</font>

<font color=Black>g</font> <font color="#b2590f">::</font> <font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Green>Int</font>
<font color=Black>g</font> x <font color="#b2590f">=</font> x <font color=Black>+</font> <font color="#0000ee">2</font>

<font color=Black>f</font> <font color="#b2590f">::</font> <font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Green>Int</font>
<font color=Black>f</font> x <font color="#b2590f">=</font> g <font color=Black>$</font> g x</pre>
<p>    :</p>
<pre><font color=Black>ghc</font> <font color="#2149c1">-</font>c <font color="#2149c1">-</font>ddump<font color="#2149c1">-</font>hi <font color="#2149c1">-</font><font color=Green>O</font> <font color=Green>Inline</font><font color=Black>.</font>hs
<font color=Black>...</font>
  f <font color="#b2590f">::</font> <font color=Green>GHC</font><font color=Black>.</font><font color=Green>Types</font><font color=Black>.</font><font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Green>GHC</font><font color=Black>.</font><font color=Green>Types</font><font color=Black>.</font><font color=Green>Int</font>
    <font color="#2149c1">{- Arity: 1, HasNoCafRefs, Strictness: U(L)m,
       Unfolding: InlineRule (1, True, False)
                  (\ x :: GHC.Types.Int -&gt;
                   case x of wild { GHC.Types.I# x1 -&gt;
                   GHC.Types.I# (GHC.Prim.+# (GHC.Prim.+# x1 2) 2) }) -}</font>
<font color=Black>...</font></pre>
<p>       .      .          <code><font color=Black>dsuppress</font><font color="#2149c1">-</font>all</code>:</p>
<pre><font color=Black>ghc</font> <font color="#2149c1">-</font>c <font color="#2149c1">-</font>ddump<font color="#2149c1">-</font>hi <font color="#2149c1">-</font>dsuppress<font color="#2149c1">-</font>all <font color="#2149c1">-</font><font color=Green>O</font> <font color=Green>Inline</font><font color=Black>.</font>hs
<font color=Black>...</font>
<font color=Black>f</font> <font color="#b2590f">::</font> <font color=Green>Int</font> <font color="#b2590f">-&gt;</font> <font color=Green>Int</font>
    <font color="#2149c1">{- Arity: 1, HasNoCafRefs, Strictness: U(L)m,
       Unfolding: InlineRule (1, True, False)
       (\ x :: Int -&gt; case x of wild { I# x1 -&gt; I# (+# (+# x1 2) 2) }) -}</font>
<font color=Black>...</font></pre>
<p> ,     <code><font color=Black>g</font></code>  .     ,  GHC           ,     <code><font color=Green>INLINE</font></code>,     ,      ,    .</p>
<p>   <code><font color=Green>NOINLINE</font></code>        .         <code><font color=Black>unsafePerformIO</font></code>,  ,     ,     .</p>
<h3 id="-rules"><a href="#-rules"> RULES</a></h3>
<p> GHC ,                .      <code><font color=Green>RULES</font></code>.             .      ,      .      . ,   :</p>
<pre><font color="#b2590f">forall</font> a b<font color=Black>.</font> a <font color=Black>+</font> b <font color="#b2590f">=</font> b <font color=Black>+</font> a</pre>
<p>  :   <code><font color=Black>a</font></code>  <code><font color=Black>b</font></code>      <code><font color=Black>(</font><font color=Black>+</font><font color=Black>)</font></code>    .    <code><font color="#b2590f">forall</font></code>   - ,     <code><font color=Green>ST</font></code>.    <code><font color=Black>runST</font></code>?    <code><font color=Black>map</font></code>:</p>
<pre><font color="#b2590f">forall</font> f g<font color=Black>.</font>   map f <font color=Black>.</font> map g <font color="#b2590f">=</font> map <font color=Black>(</font>f <font color=Black>.</font> g<font color=Black>)</font></pre>
<p>    .  ,       <code><font color=Black>map</font></code>.     .                  .   ,   ,          .     <code><font color=Black>map</font></code>       ,        .        .       :</p>
<pre><font color=Black>map</font> id <font color="#b2590f">=</font> id</pre>
<p>      ,        .       ,        ,      .</p>
<p> ,         :</p>
<pre><font color=Black>map</font> f <font color=Green>[]</font>        <font color="#b2590f">=</font> <font color=Green>[]</font>
<font color=Black>map</font> f <font color=Black>(</font>x<font color="#b2590f">:</font>xs<font color=Black>)</font>    <font color="#b2590f">=</font> f x <font color="#b2590f">:</font> map f xs

<font color=Black>map</font> id a        <font color="#b2590f">=</font> a
<font color=Black>map</font> f <font color=Black>(</font>map g x<font color=Black>)</font> <font color="#b2590f">=</font> map <font color=Black>(</font>f <font color=Black>.</font> g<font color=Black>)</font> x</pre>
<p>           ,         <code><font color=Black>map</font></code>  .  ,     ,    ,   ,   .            ,  -         ,     .      ,     ,     .</p>
<p>       <code><font color=Green>RULES</font></code>:</p>
<pre><font color="#2149c1">{-# RULES
    "map/compose"   forall f g x.  map f (map g x)  = map (f . g) x    
    "map/id"                       map id           = id 
#-}</font></pre>
<p>     .       (           ).     .       .          .        <code><font color="#b2590f">forall</font> <font color=Black>(</font><font color=Black>...</font><font color=Black>)</font> <font color=Black>.</font></code>~.    .    .     .       ,              .</p>
<p> ,   <code><font color=Green>RULES</font></code>         ,        :</p>
<pre><font color="#2149c1">{-# RULES
        "infinite"  forall a b. f a b = f b a 
#-}</font></pre>
<p>   <code><font color=Green>RULES</font></code>      .   Prelude   (fusion) .        /     .      .       <code><font color=Black>map</font></code>, <code><font color=Black>filter</font></code>  <code><font color=Black>foldr</font></code>    .</p>
<p>    <code><font color=Green>RULES</font></code>,    :</p>
<pre><font color="#b2590f">module</font> <font color=Green>Main</font> <font color="#b2590f">where</font>

<font color="#b2590f">data</font> <font color=Green>List</font> a <font color="#b2590f">=</font> <font color=Green>Nil</font> <font color="#b2590f">|</font> <font color=Green>Cons</font> a <font color=Black>(</font><font color=Green>List</font> a<font color=Black>)</font>
    <font color="#b2590f">deriving</font> <font color=Black>(</font><font color=Green>Show</font><font color=Black>)</font>

<font color=Black>foldrL</font> <font color="#b2590f">::</font> <font color=Black>(</font>a <font color="#b2590f">-&gt;</font> b <font color="#b2590f">-&gt;</font> b<font color=Black>)</font> <font color="#b2590f">-&gt;</font> b <font color="#b2590f">-&gt;</font> <font color=Green>List</font> a <font color="#b2590f">-&gt;</font> b
<font color=Black>foldrL</font> cons nil x <font color="#b2590f">=</font> <font color="#b2590f">case</font> x <font color="#b2590f">of</font>
    <font color=Green>Nil</font>         <font color="#b2590f">-&gt;</font> nil
    <font color=Green>Cons</font> a <font color="#b2590f">as</font>   <font color="#b2590f">-&gt;</font> cons a <font color=Black>(</font>foldrL cons nil <font color="#b2590f">as</font><font color=Black>)</font> 

<font color=Black>mapL</font> <font color="#b2590f">::</font> <font color=Black>(</font>a <font color="#b2590f">-&gt;</font> b<font color=Black>)</font> <font color="#b2590f">-&gt;</font> <font color=Green>List</font> a <font color="#b2590f">-&gt;</font> <font color=Green>List</font> b
<font color=Black>mapL</font> <font color="#b2590f">=</font> undefined

<font color="#2149c1">{-# RULES  
"mapL"   forall f xs.
        mapL f xs = foldrL (Cons . f) Nil xs
  #-}</font>

<font color=Black>main</font> <font color="#b2590f">=</font> print <font color=Black>$</font> mapL <font color=Black>(</font><font color=Black>+</font><font color="#0000ee">100</font><font color=Black>)</font> <font color=Black>$</font> <font color=Green>Cons</font> <font color="#0000ee">1</font> <font color=Black>$</font> <font color=Green>Cons</font> <font color="#0000ee">2</font> <font color=Black>$</font> <font color=Green>Cons</font> <font color="#0000ee">3</font> <font color=Green>Nil</font></pre>
<p> <code><font color=Black>mapL</font></code>  ,         <code><font color=Green>RULES</font></code>. ,    <code><font color=Green>RULES</font></code> ,        <code><font color=Green>O</font></code>  <code><font color=Green>O2</font></code>:</p>
<pre>$ ghc --make -O Rules.hs 
$ ./Rules
Rules: Prelude.undefined</pre>
<p>-  .   ,  GHC    . GHC     <code><font color=Black>mapL</font></code>   .     ,       .  :</p>
<pre><font color=Black>mapL</font> f xs     <font color=Black>=/=</font>   mapL f <font color=Black>$</font> xs</pre>
<p> <code><font color=Black>$</font></code>     GHC  .     ,  <code><font color=Black>$</font></code>   <code><font color=Black>mapL</font></code>        <code><font color=Black>mapL</font></code>.</p>
<h4 id="-"><a href="#-"> </a></h4>
<p>      <code><font color=Green>RULES</font></code>  <code><font color=Green>INLINE</font></code>      .       GHC       .     :</p>
<pre><font color="#2149c1">{-# INLINE [2] someFun #-}</font>
<font color="#2149c1">{-# RULES
"fun" [0] forall ... 
"fun" [1] forall ... 
"fun" [~1] forall ... 
  #-}</font></pre>
<p>    .       ,  ,  .       :      .    :       ,   .  c  :            ,    .</p>
<p>       <code><font color=Black>mapL</font></code>  <code><font color=Black>foldrL</font></code> :</p>
<pre><font color="#2149c1">{-# INLINE [1] foldrL #-}</font>
<font color=Black>foldrL</font> <font color="#b2590f">::</font> <font color=Black>(</font>a <font color="#b2590f">-&gt;</font> b <font color="#b2590f">-&gt;</font> b<font color=Black>)</font> <font color="#b2590f">-&gt;</font> b <font color="#b2590f">-&gt;</font> <font color=Green>List</font> a <font color="#b2590f">-&gt;</font> b

<font color="#2149c1">{-# INLINE [1] mapL #-}</font>
<font color=Black>mapL</font> <font color="#b2590f">::</font> <font color=Black>(</font>a <font color="#b2590f">-&gt;</font> b<font color=Black>)</font> <font color="#b2590f">-&gt;</font> <font color=Green>List</font> a <font color="#b2590f">-&gt;</font> <font color=Green>List</font> b</pre>
<p>        <code><font color=Black>ddump</font><font color="#2149c1">-</font>rule<font color="#2149c1">-</font>firings</code>.  :</p>
<pre>$ ghc --make -O Rules.hs -ddump-rule-firings
...
Rule fired: SPEC Main.$fShowList [GHC.Integer.Type.Integer]
Rule fired: mapL
Rule fired: Class op show
...
$ ./Rules 
Cons 101 (Cons 102 (Cons 103 Nil))</pre>
<p>  ,    ,   .</p>
<h3 id="-unpack"><a href="#-unpack"> UNPACK</a></h3>
<p>          .         ,    .    <code><font color=Green>INLINE</font></code>      ,    ,    <code><font color=Green>FUN</font></code>.  <code><font color=Green>UNPACK</font></code>        <code><font color=Green>CON</font></code>.       ,    Haskell    ,     ,     ,       ,       (<code><font color=Black>undefined</font></code>).     (boxed).  ,   ,      .    :</p>
<pre><font color="#b2590f">data</font> <font color=Green>Int</font> <font color="#b2590f">=</font> <font color=Green>I</font><font color=Black><em>#</em></font> <font color=Green>Int</font><font color=Black><em>#</em></font></pre>
<p>         .     ,  <code><font color=Black>undefined</font></code>   .      .      <code><font color="#b2590f">[</font><font color=Green>Pair</font> <font color="#0000ee">1</font> <font color="#0000ee">2</font><font color="#b2590f">]</font></code></p>
<pre><font color=Black>nil</font> <font color="#b2590f">=</font> <font color=Green>[]</font>                 <font color="#2149c1">--   (  )</font>

<font color="#b2590f">let</font> x1  <font color="#b2590f">=</font> <font color=Green>I</font><font color=Black><em>#</em></font> <font color="#0000ee">1</font>           <font color="#2149c1">-- 2 </font>
    x2  <font color="#b2590f">=</font> <font color=Green>I</font><font color=Black><em>#</em></font> <font color="#0000ee">2</font>           <font color="#2149c1">-- 2 </font>
    p   <font color="#b2590f">=</font> <font color=Green>Pair</font> x1 x2     <font color="#2149c1">-- 3 </font>
    val <font color="#b2590f">=</font> <font color=Green>Cons</font> p nil     <font color="#2149c1">-- 3 </font>
<font color="#b2590f">in</font>  val                  <font color="#2149c1">------------</font>
                         <font color="#2149c1">-- 10    </font></pre>
<p>       ,     .  ,          <span class="LaTeX">$N$</span>  <span class="LaTeX">$10N$</span>.      <span class="LaTeX">$2N$</span>.    <code><font color=Green>UNPACK</font></code>           .    <br />    .      (  <code><font color=Black>!</font></code>)   (     ,   ),         (   ):</p>
<pre><font color="#b2590f">data</font> <font color=Green>PairInt</font> <font color="#b2590f">=</font> <font color=Green>PairInt</font> 
    <font color="#2149c1">{-# UNPACK #-}</font> <font color=Black>!</font><font color=Green>Int</font>
    <font color="#2149c1">{-# UNPACK #-}</font> <font color=Black>!</font><font color=Green>Int</font></pre>
<p>   <code><font color=Green>Pair</font></code>        .      <code><font color=Green>Int</font></code>      <code><font color=Green>PairInt</font></code>:</p>
<pre><font color=Black>nil</font> <font color="#b2590f">=</font> <font color=Green>[]</font>                 <font color="#2149c1">--   (  )</font>

<font color="#b2590f">let</font> p   <font color="#b2590f">=</font> <font color=Green>PairInt</font> <font color="#0000ee">1</font> <font color="#0000ee">2</font>    <font color="#2149c1">-- 3 </font>
    val <font color="#b2590f">=</font> <font color=Green>Cons</font> p nil     <font color="#2149c1">-- 3 </font>
<font color="#b2590f">in</font>  val                  <font color="#2149c1">------------</font>
                         <font color="#2149c1">-- 6    </font></pre>
<p>     <span class="LaTeX">$6N$</span>.      .             ,                   :</p>
<pre><font color="#b2590f">data</font> <font color=Green>ListInt</font> <font color="#b2590f">=</font> <font color=Green>ConsInt</font> <font color="#2149c1">{-# UNPACK #-}</font> <font color=Black>!</font><font color=Green>PairInt</font> 
             <font color="#b2590f">|</font> <font color=Green>NilInt</font>

<font color=Black>nil</font> <font color="#b2590f">=</font> <font color=Green>NilInt</font>

<font color="#b2590f">let</font> val <font color="#b2590f">=</font> <font color=Green>ConsInt</font> <font color="#0000ee">1</font> <font color="#0000ee">2</font> nil   <font color="#2149c1">-- 4 </font>
<font color="#b2590f">in</font>  val                     <font color="#2149c1">-----------</font>
                            <font color="#2149c1">-- 4 </font></pre>
<p>     ,      <code><font color=Green>Cons</font></code>   . ,           <code><font color="#2149c1">-</font><font color=Green>O</font></code>  .      ,       ,     </p>
<pre><font color=Black>sumPair</font> <font color="#b2590f">::</font> <font color=Green>PairInt</font> <font color="#b2590f">-&gt;</font> <font color=Green>Int</font>
<font color=Black>sumPair</font> <font color=Black>(</font><font color=Green>Pair</font> a b<font color=Black>)</font> <font color="#b2590f">=</font> a <font color=Black>+</font> b</pre>
<p>      ,         ,       <code><font color=Green>I</font><font color=Black><em>#</em></font></code>     <code><font color=Black>+</font></code>,     ,   ,  ,  .</p>
<p>          ,           ,   .   .     ,   ,      .</p>
<p>      .    .    :</p>
<pre><font color="#b2590f">newtype</font> <font color=Green>ST</font> s a <font color="#b2590f">=</font> <font color=Green>ST</font> <font color=Black>(</font><font color=Green>STRep</font> s a<font color=Black>)</font>
<font color="#b2590f">type</font> <font color=Green>STRep</font> s a <font color="#b2590f">=</font> <font color=Green>State</font><font color=Black><em>#</em></font> s <font color="#b2590f">-&gt;</font> <font color=Black>(</font><font color=Black><em>#</em></font> <font color=Green>State</font><font color=Black><em>#</em></font> s<font color=Black>,</font> a <font color=Black><em>#</em></font><font color=Black>)</font></pre>
<p>   <code><font color=Green>ST</font></code>.        ,      .           .        <code><font color=Green>MagicHash</font></code>  <code><font color=Green>UnboxedTuples</font></code></p>
<p>        :    .   <code><font color=Green>ST</font></code>-   <code><font color=Green>STUArray</font> s i a</code>     C.        .</p>
<h2 id="-"><a href="#-"> </a></h2>
<p>     GHC.   Haskell  GHC,  GHC  Haskell.           .     ,      GHC,         .    ,     .       ,       .    :   ,  ,     .   GHC! -   :     </p>
<p>  : Hugs    (  C), nhc98    (Niklas Rjemo)         ,     NUTEK,      .     YHC,  . UHC    ,        . JHC ( , John Meacham)  LHC (    , David Himmelstrup, Austin Seipp)             .</p>
<p>         GHC.     .        ,   Haskell    Core.     Haskell.    ,    .    Core     ,      STG,        .       <code><font color=Green>Core</font></code>  <code><font color=Green>STG</font></code>     <code><font color=Black>ddump</font><font color="#2149c1">-</font>simpl</code> <code><font color=Black>ddump</font><font color="#2149c1">-</font>stg</code>      <code><font color=Black>ddump</font><font color="#2149c1">-</font>suppress<font color="#2149c1">-</font>all</code>    .   Haskell  <code><font color=Green>Core</font></code>           ,     .         Haskell.</p>
<p>              .        :          .                     . ,          .    <code><font color=Black>concat</font></code>      ,              .</p>
<p>       .    <code><font color=Green>INLINE</font></code>,    <code><font color=Green>RULE</font></code>    <code><font color=Green>UNPACK</font></code>.  GHC ,     <code><font color=Green>INLINE</font></code>     .    ,    ,          .</p>
<p>,       .   ,   ,     .             .    ,           <code><font color=Black>sum</font></code>,       100   ,        .       ,     ,       ,      .   ,   , .   , ,     ,      .    :  <code><font color=Black>auto</font><font color="#2149c1">-</font>all</code>, <code><font color=Black>caf</font><font color="#2149c1">-</font>all</code>   <code><font color=Black>prof</font></code>      <code><font color=Black>p</font></code>.</p>
<h2 id=""><a href="#"></a></h2>
<ul>
<li><p>         <code><font color=Black>sum2</font></code>   STG.    , , ,        .   STG          <code><font color="#b2590f">let</font></code>-.      ,    ,   .          <code><font color=Black>seq</font></code>.</p>
<p>:    <code><font color="#b2590f">case</font></code>-          <code><font color=Black>seq</font></code>  STG:</p>
<pre><font color=Black>seq</font> <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> a b <font color="#b2590f">-&gt;</font>
        <font color="#b2590f">case</font> a <font color="#b2590f">of</font>
            x <font color="#b2590f">-&gt;</font> b
      <font color=Black>)</font></pre>
<p>    <code><font color=Black>seq</font></code>  .        <code><font color=Black>seq</font></code>     ( <code><font color=Green>FUN</font></code>).     ,      :</p>
<pre><font color=Black>plusInt</font> <font color="#b2590f">=</font> <font color=Green>FUN</font><font color=Black>(</font> ma mb <font color="#b2590f">-&gt;</font>
            <font color="#b2590f">case</font> ma <font color="#b2590f">of</font>
                <font color=Green>I</font><font color=Black><em>#</em></font> a <font color="#b2590f">-&gt;</font> <font color="#b2590f">case</font> mb <font color="#b2590f">of</font>
                            <font color=Green>I</font><font color=Black><em>#</em></font> b <font color="#b2590f">-&gt;</font> <font color="#b2590f">case</font> <font color=Black>(</font>primitivePlus a b<font color=Black>)</font> <font color="#b2590f">of</font>
                                        res <font color="#b2590f">-&gt;</font> <font color=Green>I</font><font color=Black><em>#</em></font> res
          <font color=Black>)</font></pre>
<p>       .        Haskell,       <code><font color=Black>(</font><font color=Green>I</font><font color=Black><em>#</em></font> <font color=Black>(</font>primitivePlus a b<font color=Black>)</font><font color=Black>)</font></code>,     STG       .            <code><font color="#b2590f">let</font></code>-:</p>
<pre><font color="#b2590f">-&gt;</font> <font color="#b2590f">let</font> v <font color="#b2590f">=</font> primitivePlus a b
   <font color="#b2590f">in</font>  <font color=Green>I</font><font color=Black><em>#</em></font> v </pre>
<p>      STG!     <code><font color="#b2590f">let</font></code>-    ,      .        <code><font color=Green>THUNK</font></code>,          .     .          .         <code><font color="#b2590f">case</font></code>.     ,      .</p></li>
<li><p>   ,    .               ,        .        .         ,            .  ,         ,    ?  ,    ,           .</p></li>
<li><p>   GHC.  .     GHC.   GHC   .   Haskell-,  .           .</p></li>
<li><p>  .    <code><font color=Green>Profiling</font></code>.        retainer profiling.        ,       (    ).      ( <code><font color=Black>hr</font></code>).</p></li>
<li><p>  ,      <code><font color=Green>List</font></code>,      <code><font color=Green>RULES</font></code>.        (      <code><font color=Green>O</font></code>  )   :</p>
<pre><font color=Black>main</font> <font color="#b2590f">=</font> print <font color=Black>$</font> sumL <font color=Black>$</font> 
    mapL <font color=Black>(</font><font color="#b2590f">\</font>x <font color="#b2590f">-&gt;</font> x <font color="#2149c1">-</font> <font color="#0000ee">1000</font><font color=Black>)</font> <font color=Black>$</font> mapL <font color=Black>(</font><font color=Black>+</font><font color="#0000ee">100</font><font color=Black>)</font> <font color=Black>$</font> mapL <font color=Black>(</font><font color=Black>*</font><font color="#0000ee">2</font><font color=Black>)</font> <font color=Black>$</font> genL <font color="#0000ee">0</font> <font color="#0000ee">1e6</font></pre>
<p> <code><font color=Black>sumL</font></code>     ,  <code><font color=Black>genL</font></code>           .</p>
<p>:      (    )</p>
<pre><font color=Black>mapL</font> f <font color=Black>(</font>mapL g xs<font color=Black>)</font>              <font color="#b2590f">=</font> <font color=Black>...</font>
<font color=Black>foldrL</font> cons nil <font color=Black>(</font>mapL f xs<font color=Black>)</font>     <font color="#b2590f">=</font> <font color=Black>...</font>     </pre></li>
<li><p>   <code><font color=Green>Prelude</font></code>     .      .</p></li>
</ul>
<div id="footer">  
<div id="nav">
<a id="prev" class="button" href="9.html"><strong><code><font color="#b2590f">&lt;-</font></code></strong></a><a id="next" class="button" href="11.html"><strong><code><font color="#b2590f">-&gt;</font></code></strong></a>
<div id="home">
<a href="toc.html"><code><font color="#b2590f">::</font></code>  <code><font color="#b2590f">::</font></code></a>
</div></div>
<div id="nav"> <div id="prev-name">
<ol start="9" style="list-style-type: decimal">
<li> 
</div> <div id="wrap-next-name"><div id="next-name">
<ol start="11" style="list-style-type: decimal">
<li> 
</div></div></div>  
 </div> 
</li>
</ol></li>
</ol>
<div id="license">
   <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative commons Attribution-NonCommercial-NoDerivs</a> 3.0 Generic (CC BY-NC-ND 3.0)
</div>
</body>
</html>
